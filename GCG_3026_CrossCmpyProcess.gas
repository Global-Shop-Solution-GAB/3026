Program.Sub.ScreenSU.Start
gui.frmcrosscopy..create
gui.frmcrosscopy..caption("Copy Company info")
gui.frmcrosscopy..size(5265,5670)
gui.frmcrosscopy..minx(0)
gui.frmcrosscopy..miny(0)
gui.frmcrosscopy..position(0,0)
gui.frmcrosscopy..event(unload,frmcrosscopy_unload)
gui.frmcrosscopy..alwaysontop(False)
gui.frmcrosscopy..fontname("Arial")
gui.frmcrosscopy..fontsize(8)
gui.frmcrosscopy..forecolor(0)
gui.frmcrosscopy..fontstyle(,,,,)
gui.frmcrosscopy..BackColor(-2147483633)
gui.frmcrosscopy..controlbox(True)
gui.frmcrosscopy..maxbutton(False)
gui.frmcrosscopy..minbutton(False)
gui.frmcrosscopy..mousepointer(0)
gui.frmcrosscopy..moveable(True)
gui.frmcrosscopy..sizeable(False)
gui.frmcrosscopy..ShowInTaskBar(True)
gui.frmcrosscopy..titlebar(True)
gui.frmcrosscopy.dlsFcmpy.create(dropdownlist)
gui.frmcrosscopy.dlsFcmpy.visible(False)
gui.frmcrosscopy.dlsFcmpy.size(1860,330)
gui.frmcrosscopy.dlsFcmpy.zorder(0)
gui.frmcrosscopy.dlsFcmpy.position(4815,275)
gui.frmcrosscopy.dlsFcmpy.enabled(True)
gui.frmcrosscopy.dlsFcmpy.fontname("Arial")
gui.frmcrosscopy.dlsFcmpy.fontsize(8)
gui.frmcrosscopy.dlsFcmpy.defaultvalue("")
gui.frmcrosscopy.dlsFcmpy.controlgroup(0)
gui.frmcrosscopy.lbl1.create(label,"From Company",True,1695,255,1,60,75,True,0,Arial,8,-2147483633,0)
gui.frmcrosscopy.lbl1.defaultvalue("")
gui.frmcrosscopy.lbl1.controlgroup(0)
gui.frmcrosscopy.txtTcmpy.create(textbox,"",True,1800,300,0,2135,275,True,0,Arial,8,-2147483643,1)
gui.frmcrosscopy.txtTcmpy.defaultvalue("")
gui.frmcrosscopy.txtTcmpy.controlgroup(0)
gui.frmcrosscopy.lbl2.create(label,"Target Company",True,1440,255,1,2135,55,True,0,Arial,8,-2147483633,0)
gui.frmcrosscopy.lbl2.defaultvalue("")
gui.frmcrosscopy.lbl2.controlgroup(0)
gui.frmcrosscopy.lbl3.create(label,"Begining WO",True,1935,255,1,75,600,True,0,Arial,8,-2147483633,0)
gui.frmcrosscopy.lbl3.defaultvalue("")
gui.frmcrosscopy.lbl3.controlgroup(0)
gui.frmcrosscopy.lbl4.create(label,"Ending WO",True,1935,255,1,2115,600,True,0,Arial,8,-2147483633,0)
gui.frmcrosscopy.lbl4.defaultvalue("")
gui.frmcrosscopy.lbl4.controlgroup(0)
gui.frmcrosscopy.txtBwo.create(textbox,"",True,900,300,0,60,830,True,0,Arial,8,-2147483643,1)
gui.frmcrosscopy.txtBwo.defaultvalue("")
gui.frmcrosscopy.txtBwo.controlgroup(0)
gui.frmcrosscopy.txtEwo.create(textbox,"",True,900,300,0,2100,830,True,0,Arial,8,-2147483643,1)
gui.frmcrosscopy.txtEwo.defaultvalue("")
gui.frmcrosscopy.txtEwo.controlgroup(0)
gui.frmcrosscopy.cmdBwo.create(button)
gui.frmcrosscopy.cmdBwo.caption("^")
gui.frmcrosscopy.cmdBwo.visible(True)
gui.frmcrosscopy.cmdBwo.size(405,285)
gui.frmcrosscopy.cmdBwo.zorder(0)
gui.frmcrosscopy.cmdBwo.position(1490,830)
gui.frmcrosscopy.cmdBwo.enabled(True)
gui.frmcrosscopy.cmdBwo.fontname("Arial")
gui.frmcrosscopy.cmdBwo.fontsize(8)
gui.frmcrosscopy.cmdBwo.event(click,cmdbwo_click)
gui.frmcrosscopy.cmdBwo.defaultvalue("")
gui.frmcrosscopy.cmdBwo.controlgroup(0)
gui.frmcrosscopy.cmdEwo.create(button)
gui.frmcrosscopy.cmdEwo.caption("^")
gui.frmcrosscopy.cmdEwo.visible(True)
gui.frmcrosscopy.cmdEwo.size(405,285)
gui.frmcrosscopy.cmdEwo.zorder(0)
gui.frmcrosscopy.cmdEwo.position(3525,830)
gui.frmcrosscopy.cmdEwo.enabled(True)
gui.frmcrosscopy.cmdEwo.fontname("Arial")
gui.frmcrosscopy.cmdEwo.fontsize(8)
gui.frmcrosscopy.cmdEwo.event(click,cmdewo_click)
gui.frmcrosscopy.cmdEwo.defaultvalue("")
gui.frmcrosscopy.cmdEwo.controlgroup(0)
gui.frmcrosscopy.lvwwo.create(listview)
gui.frmcrosscopy.lvwwo.view(3)
gui.frmcrosscopy.lvwwo.visible(True)
gui.frmcrosscopy.lvwwo.size(4845,2895)
gui.frmcrosscopy.lvwwo.zorder(0)
gui.frmcrosscopy.lvwwo.position(60,1740)
gui.frmcrosscopy.lvwwo.enabled(True)
gui.frmcrosscopy.lvwwo.fontname("Arial")
gui.frmcrosscopy.lvwwo.fontsize(8)
gui.frmcrosscopy.cmdDelete.create(button)
gui.frmcrosscopy.cmdDelete.caption("Delete")
gui.frmcrosscopy.cmdDelete.visible(True)
gui.frmcrosscopy.cmdDelete.size(855,375)
gui.frmcrosscopy.cmdDelete.zorder(0)
gui.frmcrosscopy.cmdDelete.position(1030,1305)
gui.frmcrosscopy.cmdDelete.enabled(True)
gui.frmcrosscopy.cmdDelete.fontname("Arial")
gui.frmcrosscopy.cmdDelete.fontsize(8)
gui.frmcrosscopy.cmdDelete.event(click,cmddelete_click)
gui.frmcrosscopy.cmdDelete.defaultvalue("")
gui.frmcrosscopy.cmdDelete.controlgroup(0)
gui.frmcrosscopy.cmdclear.create(button)
gui.frmcrosscopy.cmdclear.caption("Clear")
gui.frmcrosscopy.cmdclear.visible(True)
gui.frmcrosscopy.cmdclear.size(855,375)
gui.frmcrosscopy.cmdclear.zorder(0)
gui.frmcrosscopy.cmdclear.position(90,1290)
gui.frmcrosscopy.cmdclear.enabled(True)
gui.frmcrosscopy.cmdclear.fontname("Arial")
gui.frmcrosscopy.cmdclear.fontsize(8)
gui.frmcrosscopy.cmdclear.event(click,cmdclear_click)
gui.frmcrosscopy.cmdclear.defaultvalue("")
gui.frmcrosscopy.cmdclear.controlgroup(0)
gui.frmcrosscopy.cmdCopy.create(button)
gui.frmcrosscopy.cmdCopy.caption("Copy")
gui.frmcrosscopy.cmdCopy.visible(True)
gui.frmcrosscopy.cmdCopy.size(855,375)
gui.frmcrosscopy.cmdCopy.zorder(0)
gui.frmcrosscopy.cmdCopy.position(95,4665)
gui.frmcrosscopy.cmdCopy.enabled(True)
gui.frmcrosscopy.cmdCopy.fontname("Arial")
gui.frmcrosscopy.cmdCopy.fontsize(8)
gui.frmcrosscopy.cmdCopy.event(click,cmdcopy_click)
gui.frmcrosscopy.cmdCopy.defaultvalue("")
gui.frmcrosscopy.cmdCopy.controlgroup(0)
gui.frmcrosscopy.cmdAdd.create(button)
gui.frmcrosscopy.cmdAdd.caption("Add")
gui.frmcrosscopy.cmdAdd.visible(True)
gui.frmcrosscopy.cmdAdd.size(840,375)
gui.frmcrosscopy.cmdAdd.zorder(0)
gui.frmcrosscopy.cmdAdd.position(4105,770)
gui.frmcrosscopy.cmdAdd.enabled(True)
gui.frmcrosscopy.cmdAdd.fontname("Arial")
gui.frmcrosscopy.cmdAdd.fontsize(8)
gui.frmcrosscopy.cmdAdd.event(click,cmdadd_click)
gui.frmcrosscopy.cmdAdd.defaultvalue("")
gui.frmcrosscopy.cmdAdd.controlgroup(0)
gui.frmcrosscopy.txtBsuffix.create(textbox,"",True,510,300,0,970,830,True,0,Arial,8,-2147483643,1)
gui.frmcrosscopy.txtBsuffix.defaultvalue("")
gui.frmcrosscopy.txtBsuffix.controlgroup(0)
gui.frmcrosscopy.txtEsuffix.create(textbox,"",True,510,300,0,3000,830,True,0,Arial,8,-2147483643,1)
gui.frmcrosscopy.txtEsuffix.defaultvalue("")
gui.frmcrosscopy.txtEsuffix.controlgroup(0)
gui.frmcrosscopy.txtFcmpy.create(textbox,"",True,1800,300,0,60,290,True,0,Arial,8,-2147483643,1)
gui.frmcrosscopy.txtFcmpy.defaultvalue("")
gui.frmcrosscopy.txtFcmpy.controlgroup(0)


Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start

Variable.UDT.uRouter.Define("Router",String,Router)
Variable.UDT.uRouter.Define("JOB",String,JOB)
Variable.UDT.uRouter.Define("SOrder",String,SOrder)
Variable.uGlobal.uRouter.Declare("uRouter")

Variable.UDT.uJHeader.Define("JOB",String,JOB)
Variable.UDT.uJHeader.Define("SUFFIX",String,SUFFIX)
Variable.UDT.uJHeader.Define("PART",String,PART)
Variable.UDT.uJHeader.Define("LOCATION",String,LOCATION)
Variable.UDT.uJHeader.Define("ROUTER",String,ROUTER)
Variable.UDT.uJHeader.Define("DESCRIPTION",String,DESCRIPTION)
Variable.UDT.uJHeader.Define("CUSTOMER",String,CUSTOMER)
Variable.UDT.uJHeader.Define("CUSTOMER_PO",String,CUSTOMER_PO)
Variable.UDT.uJHeader.Define("DATE_OPENED",String,DATE_OPENED)
Variable.UDT.uJHeader.Define("DATE_DUE",String,DATE_DUE)
Variable.UDT.uJHeader.Define("DATE_START",String,DATE_START)
Variable.UDT.uJHeader.Define("DATE_START_OTHER",String,DATE_START_OTHER)
Variable.UDT.uJHeader.Define("COMMENTS_1",String,COMMENTS_1)
Variable.UDT.uJHeader.Define("COMMENTS_2",String,COMMENTS_2)
Variable.UDT.uJHeader.Define("SALESPERSON",String,SALESPERSON)
Variable.UDT.uJHeader.Define("DATE_CLOSED",String,DATE_CLOSED)
Variable.UDT.uJHeader.Define("PRODUCT_LINE",String,PRODUCT_LINE)
Variable.UDT.uJHeader.Define("PART_DESCRIPTION",String,PART_DESCRIPTION)
Variable.UDT.uJHeader.Define("PRIORITY",String,PRIORITY)
Variable.UDT.uJHeader.Define("PROJECT",String,PROJECT)
Variable.UDT.uJHeader.Define("COMMENTS_3",String,COMMENTS_3)
Variable.UDT.uJHeader.Define("PARENT_WO",String,PARENT_WO)
Variable.UDT.uJHeader.Define("PARENT_SUFFIX_PARENT",String,PARENT_SUFFIX_PARENT)
Variable.UDT.uJHeader.Define("USERCODE",String)
Variable.UDT.uJHeader.Define("AMT_PRICE_PER_UNIT",String,AMT_PRICE_PER_UNIT)
Variable.UDT.uJHeader.Define("QTY_COMPLETED",String,QTY_COMPLETED)
Variable.UDT.uJHeader.Define("QTY_CUSTOMER",String,QTY_CUSTOMER)
Variable.UDT.uJHeader.Define("QTY_ORDER",String,QTY_ORDER)
Variable.uGlobal.uJHeader.Declare("uJHeader")



Variable.UDT.uJobOUPL.Define("JOB",String,JOB)
Variable.UDT.uJobOUPL.Define("SUFFIX",String,SUFFIX)
Variable.UDT.uJobOUPL.Define("SEQ",String,SEQ)
Variable.UDT.uJobOUPL.Define("OPERATION",String,OPERATION)
Variable.UDT.uJobOUPL.Define("FLAG_SET_UP",String,FLAG_SET_UP)
Variable.UDT.uJobOUPL.Define("LMO",String,LMO)
Variable.UDT.uJobOUPL.Define("DESCRIPTION",String,DESCRIPTION)
Variable.UDT.uJobOUPL.Define("UM",String,UM)

Variable.UDT.uJobOUPL.Define("Machine1",String)
Variable.UDT.uJobOUPL.Define("Machine2",String)
Variable.UDT.uJobOUPL.Define("Machine3",String)
Variable.UDT.uJobOUPL.Define("Machine4",String)
Variable.UDT.uJobOUPL.Define("Machine5",String)

Variable.UDT.uJobOUPL.Define("ROUTER",String,ROUTER)
Variable.UDT.uJobOUPL.Define("ROUTER_SEQ",String,ROUTER_SEQ)
Variable.UDT.uJobOUPL.Define("DATE_START",String,DATE_START)
Variable.UDT.uJobOUPL.Define("DATE_DUE",String,DATE_DUE)
Variable.UDT.uJobOUPL.Define("DATE_PO_ORDER",String,DATE_PO_ORDER)
Variable.UDT.uJobOUPL.Define("SETUP",String,SETUP)
Variable.UDT.uJobOUPL.Define("HOURS_ESTIMATED",String,HOURS_ESTIMATED)
Variable.UDT.uJobOUPL.Define("RATE_PIECE",String,RATE_PIECE)
Variable.UDT.uJobOUPL.Define("CODE_SORT_OPER",String,CODE_SORT_OPER)
Variable.UDT.uJobOUPL.Define("PROJ_GROUP",String,PROJ_GROUP)
Variable.UDT.uJobOUPL.Define("TASK_SIGNOFF_USER",String,TASK_SIGNOFF_USER)
Variable.UDT.uJobOUPL.Define("TASK_COMP_REQ",String,TASK_COMP_REQ)
Variable.UDT.uJobOUPL.Define("NO_ROUTER_UPDATE",String,NO_ROUTER_UPDATE)
Variable.UDT.uJobOUPL.Define("OVERLAP",String,OVERLAP)
Variable.UDT.uJobOUPL.Define("RATE_BURDEN",String,RATE_BURDEN)
Variable.UDT.uJobOUPL.Define("RATE",String)
Variable.UDT.uJobOUPL.Define("PWC",String,PART)
Variable.uGlobal.uJobOUPL.Declare("uJobOUPL")




Variable.UDT.uORDUPL.Define("Transaction",String)
Variable.UDT.uORDUPL.Define("Customer",String)
Variable.UDT.uORDUPL.Define("Order_No",String)
Variable.UDT.uORDUPL.Define("Freight",String)
Variable.UDT.uORDUPL.Define("Tax_Freight_Flag",String)
Variable.UDT.uORDUPL.Define("FreightPerPiece",String)
Variable.UDT.uORDUPL.Define("DateDue_Order",String)
Variable.UDT.uORDUPL.Define("Header_User1",String)
Variable.UDT.uORDUPL.Define("Header_User2",String)
Variable.UDT.uORDUPL.Define("Header_User3",String)
Variable.UDT.uORDUPL.Define("Header_User4",String)
Variable.UDT.uORDUPL.Define("Header_User5",String)
Variable.UDT.uORDUPL.Define("UserId",String)
Variable.UDT.uORDUPL.Define("Customer_PO",String)
Variable.UDT.uORDUPL.Define("Freight_CurrFlag",String)
Variable.UDT.uORDUPL.Define("Data_Type_Ship",String)
Variable.UDT.uORDUPL.Define("Ship_Via",String)
Variable.UDT.uORDUPL.Define("Carrier",String)
Variable.UDT.uORDUPL.Define("Ship_To_Name",String)
Variable.UDT.uORDUPL.Define("Ship_To_Address2",String)
Variable.UDT.uORDUPL.Define("Ship_To_Address3",String)
Variable.UDT.uORDUPL.Define("Ship_To_City",String)
Variable.UDT.uORDUPL.Define("Ship_To_State",String)
Variable.UDT.uORDUPL.Define("Ship_To_Zip",String)
Variable.UDT.uORDUPL.Define("Ship_To_Country",String)
Variable.UDT.uORDUPL.Define("Ship_To_Attn",String)
Variable.UDT.uORDUPL.Define("Order_Type",String)
Variable.UDT.uORDUPL.Define("Order_Discount_Perc",String)
Variable.UDT.uORDUPL.Define("Salesman",String)
Variable.UDT.uORDUPL.Define("Ovrd_Auto_Num",String)
Variable.UDT.uORDUPL.Define("Ship_To_ID",String)
Variable.UDT.uORDUPL.Define("Mark_Shipment",String)
Variable.UDT.uORDUPL.Define("Contact_Name",String)
Variable.UDT.uORDUPL.Define("Line_No",String)
Variable.UDT.uORDUPL.Define("Qty_Order",String)
Variable.UDT.uORDUPL.Define("Weight_Ln",String)
Variable.UDT.uORDUPL.Define("UM",String)
Variable.UDT.uORDUPL.Define("Part",String)
Variable.UDT.uORDUPL.Define("Location",String)
Variable.UDT.uORDUPL.Define("Quote_Price",String)
Variable.UDT.uORDUPL.Define("Ovrd_Price",String)
Variable.UDT.uORDUPL.Define("Cost",String)
Variable.UDT.uORDUPL.Define("Description",String)
Variable.UDT.uORDUPL.Define("PL",String)
Variable.UDT.uORDUPL.Define("Date_Order_Line",String)
Variable.UDT.uORDUPL.Define("Promise_Date_Line",String)
Variable.UDT.uORDUPL.Define("Ln_User1",String)
Variable.UDT.uORDUPL.Define("Ln_User2",String)
Variable.UDT.uORDUPL.Define("Ln_User3",String)
Variable.UDT.uORDUPL.Define("Ln_User4",String)
Variable.UDT.uORDUPL.Define("Ln_User5",String)
Variable.UDT.uORDUPL.Define("Extention",String)
Variable.UDT.uORDUPL.Define("Date_NoDeliv_Before",String)
Variable.UDT.uORDUPL.Define("Date_Must_Deliv_By",String)
Variable.UDT.uORDUPL.Define("Txt_Data_Type",String)
Variable.UDT.uORDUPL.Define("Text_Line1",String)
Variable.UDT.uORDUPL.Define("Text_Line2",String)
Variable.UDT.uORDUPL.Define("Text_Line3",String)
Variable.UDT.uORDUPL.Define("Text_Line4",String)
Variable.UDT.uORDUPL.Define("Text_Line5",String)
Variable.UDT.uORDUPL.Define("Text_Line6",String)
Variable.UDT.uORDUPL.Define("Text_Line7",String)
Variable.UDT.uORDUPL.Define("Text_Line8",String)
Variable.UDT.uORDUPL.Define("Text_Line9",String)
Variable.UDT.uORDUPL.Define("Text_Line10",String)
Variable.UDT.uORDUPL.Define("Tax_Stat_Flag",String)
Variable.UDT.uORDUPL.Define("Line_Type",String)
Variable.UDT.uORDUPL.Define("Negative_Flag",String)
Variable.UDT.uORDUPL.Define("Price_Flag",String)
Variable.UDT.uORDUPL.Define("Suff_Inv_Check",String)
Variable.UDT.uORDUPL.Define("Order_Disc_Pct",String)
Variable.UDT.uORDUPL.Define("Ship_Intl_Flag",String)
Variable.UDT.uORDUPL.Define("Ship_to_NameExt",String)
Variable.UDT.uORDUPL.Define("Ship_To_Addr1Ext",String)
Variable.UDT.uORDUPL.Define("Ship_To_Addr2Ext",String)
Variable.UDT.uORDUPL.Define("Ship_To_Addr3Ext",String)
Variable.UDT.uORDUPL.Define("Ship_To_Addr4Ext",String)
Variable.UDT.uORDUPL.Define("Ship_To_Addr5Ext",String)
Variable.UDT.uORDUPL.Define("Ship_To_CityExt",String)
Variable.UDT.uORDUPL.Define("Ship_To_StateExt",String)
Variable.UDT.uORDUPL.Define("Ship_To_ZipExt",String)
Variable.UDT.uORDUPL.Define("Ship_To_CtryExt",String)
Variable.UDT.uORDUPL.Define("Ship_To_AttnExt",String)
Variable.UDT.uORDUPL.Define("Bill_To_Name",String)
Variable.UDT.uORDUPL.Define("Bill_To_Address1",String)
Variable.UDT.uORDUPL.Define("Bill_To_Address2",String)
Variable.UDT.uORDUPL.Define("Bill_To_Address3",String)
Variable.UDT.uORDUPL.Define("Bill_To_Address4",String)
Variable.UDT.uORDUPL.Define("Bill_To_Address5",String)
Variable.UDT.uORDUPL.Define("Bill_To_City",String)
Variable.UDT.uORDUPL.Define("Bill_To_State",String)
Variable.UDT.uORDUPL.Define("Bill_To_Zip",String)
Variable.UDT.uORDUPL.Define("Bill_To_Country",String)
Variable.UDT.uORDUPL.Define("Bill_To_Attn",String)
Variable.UDT.uORDUPL.Define("Contact_Email",String)
Variable.UDT.uORDUPL.Define("Contact_Phone",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_1",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_2",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_3",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_4",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_5",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_6",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_7",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_8",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_9",String)
Variable.UDT.uORDUPL.Define("Hdr_Text_10",String)
Variable.UDT.uORDUPL.Define("Text_Position",String)
Variable.UDT.uORDUPL.Define("Hdr_Txt_Apply_SO",String)
Variable.UDT.uORDUPL.Define("Hdr_Txt_Apply_PL",String)
Variable.UDT.uORDUPL.Define("Hdr_Txt_Apply_Inv",String)
Variable.UDT.uORDUPL.Define("Hdr_Txt_Apply_Qt",String)
Variable.UDT.uORDUPL.Define("Hdr_Txt_Apply_Router",String)
Variable.UDT.uORDUPL.Define("Hdr_Txt_Apply_WO",String)
Variable.UDT.uORDUPL.Define("Survey_No",String)
Variable.UDT.uORDUPL.Define("Router_Val_Flag",String)
Variable.UDT.uORDUPL.Define("Router",String)
Variable.UDT.uORDUPL.Define("Router_Seq",String)
Variable.UDT.uORDUPL.Define("Stock_XRef",String)
Variable.UDT.uORDUPL.Define("Origin_OrderNo",String)
Variable.UDT.uORDUPL.Define("Origin_Order_Line",String)
Variable.UDT.uORDUPL.Define("Length",String)
Variable.UDT.uORDUPL.Define("Width",String)
Variable.UDT.uORDUPL.Define("Curr_Flag",String)
Variable.UDT.uORDUPL.Define("PAY_METHOD",String)
Variable.UDT.uORDUPL.Define("PAY_OWNER_NAME",String)
Variable.UDT.uORDUPL.Define("PAY_CC_TYPE",String)
Variable.UDT.uORDUPL.Define("PAY_CC_NO",String)
Variable.UDT.uORDUPL.Define("PAY_CC_LENGTH",String)
Variable.UDT.uORDUPL.Define("PAY_CC_EXP_DATE",String)
Variable.UDT.uORDUPL.Define("PAY_CC_CVV",String)
Variable.UDT.uORDUPL.Define("PAY_CVV_LENGTH",String)
Variable.UDT.uORDUPL.Define("Ship_To_Address1",String)
Variable.uGlobal.uOrders.Declare("uORDUPL")

Variable.UDT.UOrderLines.Define("RECORD_NO",String,RECORD_NO)
Variable.UDT.UOrderLines.Define("QTY_ORDERED",String,QTY_ORDERED)
Variable.UDT.UOrderLines.Define("PART",String,PART)
Variable.UDT.uOrder.Define("Transaction",String)
Variable.UDT.uOrder.Define("CustomerNo",String)
Variable.UDT.uOrder.Define("ORDER_NO",String,ORDER_NO)
Variable.uGlobal.uOrder.Declare("uOrder")
Variable.uGlobal.uOrdLines.Declare("UOrderLines")
Program.External.Include.Library("GCG_3026_RouterUpload.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
' RAN 10/22/2015
' Project Name: - Copy certain routers, jobs, sales order to company
' Hahn & Clay


F.Intrinsic.Control.SetErrorHandler("Main_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sCompcodes.Declare(String)
V.Local.lcounter.Declare(Long)
V.Local.suser.Declare(String)

V.Global.uCurrentCompanyCode.Declare(String)
V.Global.uTargetCompCode.Declare(String)
V.Global.sJobList.Declare(String)
V.Global.sOrderNoList.Declare(String)
V.Global.sOrderLnList.Declare(String)
V.Global.sRouterList.Declare(String)
V.Global.sOrders.Declare(String)
V.global.sOrderAddList.Declare(String)



V.uGlobal.uRouter.redim(-1,-1)

Gui.frmcrosscopy.txtTcmpy.Locked(true)
Gui.frmcrosscopy.txtFcmpy.Locked(true)

Gui.frmcrosscopy.txtBwo.locked(true)
Gui.frmcrosscopy.txtEwo.Locked(true)
Gui.frmcrosscopy.txtBsuffix.locked(true)
Gui.frmcrosscopy.txtEsuffix.Locked(true)


Gui.frmcrosscopy.lvwwo.AddListViewColumn("From WO",1450,0)
Gui.frmcrosscopy.lvwwo.AddListViewColumn("Suffix",930,0)
Gui.frmcrosscopy.lvwwo.AddListViewColumn("To WO",1450,0)
Gui.frmcrosscopy.lvwwo.AddListViewColumn("Suffix",930,0)

'**Company Code =  Customer Numbers involved
'HCS=000100
'HAH=000101

'getcompanycode
Gui.frmcrosscopy.txtFcmpy.Text(V.Caller.CompanyCode)
F.Intrinsic.Control.If(V.Caller.CompanyCode,=,"HCS")
	Gui.frmcrosscopy.txtTcmpy.Text("HAH")
	Gui.frmcrosscopy.txtTcmpy.SetMetaData("000100")
F.Intrinsic.Control.elseIf(V.Caller.CompanyCode,=,"HAH")
	Gui.frmcrosscopy.txtTcmpy.Text("HCS")
	Gui.frmcrosscopy.txtTcmpy.SetMetaData("000101")
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Operation not allowed, Invalid company code")
	F.Intrinsic.Control.End

F.Intrinsic.Control.endif

''''test
'Gui.frmcrosscopy.txtFcmpy.Text(V.Caller.CompanyCode)
'Gui.frmcrosscopy.txtTcmpy.Text("WAW")
'Gui.frmcrosscopy.txtTcmpy.SetMetaData("MK")

'Opens Connection
F.ODBC.Connection!con.OpenConnection(V.Ambient.PDSN,V.Ambient.PUser,V.Ambient.PPass,10000)



Gui.frmcrosscopy..Show


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Main_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.Main.End

program.sub.frmcrosscopy_unload.start
F.Intrinsic.Control.SetErrorHandler("frmcrosscopy_unload_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


F.ODBC.Connection!con.Close

F.Intrinsic.Control.End

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("frmcrosscopy_unload_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


program.sub.frmcrosscopy_unload.End

program.sub.cmddelete_click.start
F.Intrinsic.Control.SetErrorHandler("cmddelete_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

Gui.frmcrosscopy.lvwwo.RemoveItem(V.Screen.frmcrosscopy!lvwwo.SelectedItemKey)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmddelete_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


program.sub.cmddelete_click.End

program.sub.cmdclear_click.start
F.Intrinsic.Control.SetErrorHandler("cmdclear_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

Gui.frmcrosscopy.lvwwo.ClearItems

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdclear_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


program.sub.cmdclear_click.End

program.sub.cmdbwo_click.start
F.Intrinsic.Control.SetErrorHandler("cmdbwo_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sRet.Declare(String)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser(1000,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.frmcrosscopy.txtBwo.text(V.Local.sRet(0))
	Gui.frmcrosscopy.txtBsuffix.text(V.Local.sRet(1))
	
	Gui.frmcrosscopy.txtEwo.text(V.Local.sRet(0))
	Gui.frmcrosscopy.txtEsuffix.Text(V.Local.sRet(1))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdbwo_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


program.sub.cmdbwo_click.End

program.sub.cmdewo_click.start
F.Intrinsic.Control.SetErrorHandler("cmdewo_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.sRet.Declare(String)

F.Intrinsic.UI.SetBrowserHotTypeAhead(True)
F.Intrinsic.UI.Browser(1000,"",V.Local.sRet)

F.Intrinsic.Control.If(V.Local.sRet,<>,"***CANCEL***")
	F.Intrinsic.String.Split(V.Local.sRet,"*!*",V.Local.sRet)
	Gui.frmcrosscopy.txtEwo.text(V.Local.sRet(0))
	Gui.frmcrosscopy.txtEsuffix.Text(V.Local.sRet(1))
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdewo_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


program.sub.cmdewo_click.End

program.sub.cmdadd_click.start
F.Intrinsic.Control.SetErrorHandler("cmdadd_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.llstkey.Declare(String)


F.Intrinsic.Control.If(V.Screen.frmcrosscopy!txtBwo.Text,"=","")
	F.Intrinsic.UI.Msgbox("Please select work order")
	Gui.frmcrosscopy.txtBwo.SetFocus
	F.Intrinsic.Control.ExitSub
Function.Intrinsic.Control.EndIf

V.Local.llstkey.Set(V.Screen.frmcrosscopy!lvwwo.ListItemCount)

Gui.frmcrosscopy.lvwwo.AddListItem(V.Local.llstkey,V.Screen.frmcrosscopy!txtBwo.Text)
Gui.frmcrosscopy.lvwwo.SetListItemSubItemText(V.Local.llstkey,1,V.Screen.frmcrosscopy!txtBsuffix.Text)
Gui.frmcrosscopy.lvwwo.SetListItemSubItemText(V.Local.llstkey,2,V.Screen.frmcrosscopy!txtEwo.Text)
Gui.frmcrosscopy.lvwwo.SetListItemSubItemText(V.Local.llstkey,3,V.Screen.frmcrosscopy!txtEsuffix.Text)

Gui.frmcrosscopy.txtBwo.Text("")
Gui.frmcrosscopy.txtBsuffix.Text("")
Gui.frmcrosscopy.txtEwo.Text("")
Gui.frmcrosscopy.txtEsuffix.Text("")

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdadd_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf



program.sub.cmdadd_click.End

program.sub.cmdcopy_click.start
F.Intrinsic.Control.SetErrorHandler("cmdcopy_click_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.slvwo.Declare(String)
V.Local.lcounter.Declare(Long)
V.Local.lRet.Declare(Long)
V.Local.sRet.Declare(String)
V.Local.sRange.Declare(String)
V.Local.sSql.Declare(String)


V.Local.sfilevalue.Declare(String)
V.Local.sdir.Declare(String)
V.Local.bRet.Declare(String)

V.global.sJobList.Set("")
V.global.sOrderNoList.Set("")
V.global.sOrderLnList.Set("")
V.global.sOrderAddList.Set("")
V.global.sRouterList.Set("")

V.global.sJobList.Set("")

F.Intrinsic.Control.If(V.Screen.frmcrosscopy!txtFcmpy.text,"=","")
	F.Intrinsic.UI.Msgbox("From company cannot be blank")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.elseIf(V.Screen.frmcrosscopy!txtTcmpy.text,"=","")
	F.Intrinsic.UI.Msgbox("Target company cannot be blank")
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.else
	Gui.frmcrosscopy.lvwwo.RetrieveAllListItems(V.Local.slvwo)
	F.Intrinsic.Control.If(V.Local.slvwo,"=","***NORETURN***")
		F.Intrinsic.UI.Msgbox("Please add work order to the list")
		Gui.frmcrosscopy.txtBwo.SetFocus
		F.Intrinsic.Control.ExitSub
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}\WEB_ORDERS",Variable.Caller.FilesDir,V.Local.sdir)
		Function.Intrinsic.File.DirExists(V.Local.sdir,V.Local.bRet)
		F.Intrinsic.Control.If(V.Local.bRet,=,False)
			F.Intrinsic.Control.CallSub(Paramfile)
		F.Intrinsic.Control.EndIf
'F.Intrinsic.Debug.InvokeDebugger


		V.Global.uCurrentCompanyCode.Set(V.Screen.frmcrosscopy!txtFcmpy.text)
		V.Global.uTargetCompCode.Set(V.Screen.frmcrosscopy!txtTcmpy.text)

		F.Intrinsic.String.Split(V.Local.slvwo,"*!*",V.Local.slvwo)
		F.Intrinsic.UI.InvokeWaitDialog("Copying Routers,Sales Orders, Work Orders")
		Gui.frmcrosscopy..Visible(false)
		F.Intrinsic.Control.For(V.Local.lcounter,V.Local.slvwo.LBound,V.Local.slvwo.UBound,1)
			Gui.frmcrosscopy.lvwwo.RetrieveItemOrdinal(V.Local.lcounter,V.Local.lRet)
			V.Local.sRange.set(V.Screen.frmcrosscopy!lvwwo.ListItemTextExtended(V.Local.lRet))
			F.Intrinsic.String.Split(V.Local.sRange,"*!*",V.Local.sRange)
			' Sales_Order_Line missing (last) one char (0)
			F.Intrinsic.String.Build("select  rtrim(ltrim(router)),rtrim(ltrim(job)) + rtrim(ltrim(suffix)) as job,rtrim(ltrim(Sales_Order)) + rtrim(ltrim(Sales_Order_Line)) as SLnOrder , rtrim(ltrim(Sales_Order)) as SOrder from v_job_header where job + suffix between '{0}{1}' and '{2}{3}'",V.Local.sRange(0),V.Local.sRange(1),V.Local.sRange(2),V.Local.sRange(3),V.Local.sSql)
			F.Intrinsic.Debug.Stop
			F.ODBC.Connection!con.OpenLocalRecordsetRO("rst",V.Local.sSql)
			F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,False)
				F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValtrim!Job,<>,"")
					F.Intrinsic.Control.If(V.global.sJobList,=,"")
						F.Intrinsic.String.Build("('{0}'",V.ODBC.con!rst.FieldValtrim!Job,V.global.sJobList)
					F.Intrinsic.Control.else
						F.Intrinsic.String.Build("{0},'{1}'",V.global.sJobList,V.ODBC.con!rst.FieldValtrim!Job,V.global.sJobList)
					F.Intrinsic.Control.endif
				F.Intrinsic.Control.endif

'				F.Intrinsic.Control.If(V.ODBC.con!rst.FieldVal!SOrder,<>,"")
				F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValLong!SOrder,>,0)
'F.Intrinsic.Debug.Stop
					F.Intrinsic.Control.If(V.global.sOrderNoList,=,"")
						F.Intrinsic.String.Build("('{0}'",V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderNoList)
						F.Intrinsic.String.Build("('{0}0'",V.ODBC.con!rst.FieldValtrim!SLnOrder,V.global.sOrderLnList)
						
						F.Intrinsic.String.Build("('{0}B'",V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderaddList)
						F.Intrinsic.String.Build("{0},'{1}C'",V.global.sOrderaddList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderaddList)


						F.Intrinsic.String.Build("{0},'{1}A'",V.global.sOrderLnList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderLnList)
						F.Intrinsic.String.Build("{0},'{1}B'",V.global.sOrderLnList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderLnList)
						F.Intrinsic.String.Build("{0},'{1}C'",V.global.sOrderLnList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderLnList)

					F.Intrinsic.Control.else
						F.Intrinsic.String.Build("{0},'{1}'",V.global.sOrderNoList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderNoList)
						F.Intrinsic.String.Build("{0},'{1}0'",V.global.sOrderLnList,V.ODBC.con!rst.FieldValtrim!SLnOrder,V.global.sOrderLnList)

						F.Intrinsic.String.Build("{0},'{1}A'",V.global.sOrderLnList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderLnList)
						F.Intrinsic.String.Build("{0},'{1}B'",V.global.sOrderLnList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderLnList)
						F.Intrinsic.String.Build("{0},'{1}C'",V.global.sOrderLnList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderLnList)

						F.Intrinsic.String.Build("{0},'{1}B'",V.global.sOrderaddList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderaddList)
						F.Intrinsic.String.Build("{0},'{1}C'",V.global.sOrderaddList,V.ODBC.con!rst.FieldValtrim!SOrder,V.global.sOrderaddList)

					F.Intrinsic.Control.endif
				F.Intrinsic.Control.endif

				F.Intrinsic.Control.If(V.ODBC.con!rst.FieldValtrim!router,<>,"")
					F.Intrinsic.Control.If(V.global.sRouterList,=,"")
						F.Intrinsic.String.Build("('{0}'",V.ODBC.con!rst.FieldValtrim!router,V.global.sRouterList)
					F.Intrinsic.Control.else
						F.Intrinsic.String.Build("{0},'{1}'",V.global.sRouterList,V.ODBC.con!rst.FieldValtrim!router,V.global.sRouterList)
					F.Intrinsic.Control.endif
				F.Intrinsic.Control.endif

			F.Intrinsic.Control.endif
			F.ODBC.con!rst.Close
		F.Intrinsic.Control.Next(V.Local.lcounter)
	
		F.Intrinsic.Control.If(V.global.sRouterList,<>,"")
			F.Intrinsic.String.Build("{0})",V.global.sRouterList,V.global.sRouterList)
			F.Intrinsic.Control.CallSub(Routerupload)
		F.Intrinsic.Control.endif

		F.Intrinsic.Control.If(V.global.sJobList,<>,"")
			F.Intrinsic.String.Build("{0})",V.global.sJobList,V.global.sJobList)
			F.Intrinsic.Control.CallSub(Woupload)
		F.Intrinsic.Control.endif

		F.Intrinsic.Control.If(V.global.sOrderNoList,<>,"")
			F.Intrinsic.String.Build("{0})",V.global.sOrderLnList,V.global.sOrderLnList)
			F.Intrinsic.String.Build("{0})",V.global.sOrderNoList,V.global.sOrderNoList)
			F.Intrinsic.String.Build("{0})",V.global.sOrderaddList,V.global.sOrderaddList)
			F.Intrinsic.Control.CallSub(Orderupload)
		F.Intrinsic.Control.endif

		F.Intrinsic.UI.Msgbox("Processing Complete")
		Gui.frmcrosscopy..Visible(true)
'		F.Intrinsic.Control.End

	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.EndIf

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("cmdcopy_click_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


program.sub.cmdcopy_click.End

Program.Sub.RouterHeader2.Start
F.Intrinsic.Control.SetErrorHandler("RouterHeader2_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSql.Declare(String)
V.Local.lNewline.Declare(Long)
V.local.lRtrCount.Declare(Long)


V.Local.iheader.Declare(Long)
V.local.ssqlheader.Declare(String)
V.Local.ssqlheader2.Declare(String)
V.Local.ssqlheader3.Declare(String)
V.Local.ssqlheader4.Declare(String)



'load the udt for the header upload

F.Intrinsic.String.Build("Select * from  ROUTER_HEADER where ROUTER  in {0}",V.global.sRouterList,V.Local.sSql)
F.ODBC.Connection!con.OpenLocalRecordsetRO("rst",V.Local.sSql)

F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,True)
	F.Intrinsic.UI.Msgbox("Router not found")
	F.ODBC.con!rst.Close
	F.Intrinsic.Control.End

F.Intrinsic.Control.EndIf

F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,True)
	F.Intrinsic.Math.Add(V.local.lRtrCount,1,V.local.lRtrCount)
	F.ODBC.con!rst.MoveNext
F.Intrinsic.Control.Loop

F.Intrinsic.Math.sub(V.local.lRtrCount,1,V.local.lRtrCount)
V.uGlobal.uRtr.Redim(0,V.local.lRtrCount)

F.ODBC.con!rst.Movefirst
F.Intrinsic.Control.DoUntil(V.ODBC.con!rst.EOF,=,True)
	
		V.uGlobal.uRtr(v.Local.iheader)!Number.Set(V.ODBC.con!rst.FieldValTrim!ROUTER)

		V.uGlobal.uRtr(v.Local.iheader)!Desc.Set(V.ODBC.con!rst.FieldValTrim!DESCRIPTION_ROUTER)
		V.uGlobal.uRtr(V.Local.iheader)!CUSTOMER.Set(V.Screen.frmcrosscopy!txtTcmpy.MetaData0)
		V.uGlobal.uRtr(v.Local.iheader)!UM.Set(V.ODBC.con!rst.FieldValtrim!UM_INVENTORY)
		V.uGlobal.uRtr(v.Local.iheader)!Purge.Set(V.ODBC.con!rst.FieldValTrim!PURGE_FLAG)
		V.uGlobal.uRtr(V.Local.iheader)!Drawing.Set(V.ODBC.con!rst.FieldValTrim!DRAWING_CUSTOMER)
		V.uGlobal.uRtr(v.Local.iheader)!Orig_Date.Set(V.ODBC.con!rst.FieldValTrim!DATE_ORIGINAL)
		V.uGlobal.uRtr(v.Local.iheader)!CUST_Part.Set(V.ODBC.con!rst.FieldValTrim!PART_CUSTOMER)
		V.uGlobal.uRtr(v.Local.iheader)!No_Reprice.Set(V.ODBC.con!rst.FieldValTrim!NO_REPRICE)

		'get the quantities 1-4
		F.Intrinsic.String.build("select QUANTITY_1, QUANTITY_2, QUANTITY_3, QUANTITY_4 FROM V_RTR_PRICE_1_4 WHERE ROUTER = '{0}'",V.ODBC.con!rst.FieldValTrim!ROUTER,V.Local.ssqlheader2)
		F.ODBC.Connection!con.OpenLocalRecordsetRO("rst5",V.Local.ssqlheader2)
		F.Intrinsic.Control.If(V.ODBC.con!rst5.EOF,=,False)
			V.uGlobal.uRtr(v.Local.iheader)!Qty1.Set(V.ODBC.con!rst5.FieldValtrim!QUANTITY_1)
			V.uGlobal.uRtr(v.Local.iheader)!Qty2.Set(V.ODBC.con!rst5.Fieldvaltrim!QUANTITY_2)
			V.uGlobal.uRtr(v.Local.iheader)!Qty3.Set(V.ODBC.con!rst5.FieldValtrim!QUANTITY_3)
			V.uGlobal.uRtr(v.Local.iheader)!Qty4.Set(V.ODBC.con!rst5.FieldValtrim!QUANTITY_4)
		F.Intrinsic.Control.EndIf
		F.ODBC.con!rst5.Close
		
		'get the quantities 5-8
		F.Intrinsic.String.Build("select QUANTITY_5, QUANTITY_6, QUANTITY_7, QUANTITY_8 FROM V_RTR_PRICE_5_8 WHERE ROUTER = '{0}'",V.ODBC.con!rst.FieldValTrim!ROUTER,V.Local.ssqlheader3)
		F.ODBC.Connection!con.OpenLocalRecordsetRO("rst6",V.Local.ssqlheader3)
		F.Intrinsic.Control.If(V.ODBC.con!rst6.EOF,=,False)
			V.uGlobal.uRtr(v.Local.iheader)!Qty5.Set(V.ODBC.con!rst6.FieldValTrim!QUANTITY_5)
			V.uGlobal.uRtr(v.Local.iheader)!Qty6.Set(V.ODBC.con!rst6.FieldValTrim!QUANTITY_6)
			V.uGlobal.uRtr(v.Local.iheader)!Qty7.Set(V.ODBC.con!rst6.FieldValTrim!QUANTITY_7)
			V.uGlobal.uRtr(v.Local.iheader)!Qty8.Set(V.ODBC.con!rst6.FieldValTrim!QUANTITY_8)
		F.Intrinsic.Control.EndIf
		F.ODBC.con!rst6.Close

		'get the quantities 9-10
		F.Intrinsic.String.Build("SELECT QUANTITY_9, QUANTITY_10 FROM V_RTR_PRICE_9_10 WHERE ROUTER = '{0}'",V.ODBC.con!rst.FieldValTrim!ROUTER,V.Local.ssqlheader4)
		F.ODBC.Connection!con.OpenLocalRecordsetRO("rst7",V.Local.ssqlheader4)
		F.Intrinsic.Control.If(V.ODBC.con!rst7.EOF,=,False)
			V.uGlobal.uRtr(v.Local.iheader)!Qty9.Set(V.ODBC.con!rst7.FieldValTrim!QUANTITY_9)
			V.uGlobal.uRtr(v.Local.iheader)!Qty10.Set(V.ODBC.con!rst7.FieldValTrim!QUANTITY_10)
		F.Intrinsic.Control.EndIf
		F.ODBC.con!rst7.Close

		V.uGlobal.uRtr(v.Local.iheader)!Scrap.Set(V.ODBC.con!rst.FieldValTrim!SCRAP)
		V.uGlobal.uRtr(v.Local.iheader)!Sort1.Set(V.ODBC.con!rst.FieldValTrim!SORT_1)
		V.uGlobal.uRtr(v.Local.iheader)!Sort2.Set(V.ODBC.con!rst.FieldValTrim!SORT_2)
		V.uGlobal.uRtr(v.Local.iheader)!Commission.Set(V.ODBC.con!rst.FieldValFloat!COMMISSION)
		V.uGlobal.uRtr(v.Local.iheader)!Prod_Line.Set(V.ODBC.con!rst.FieldValTrim!PROD_LINE)

		F.Intrinsic.Math.Add(V.Local.iheader,1,V.Local.iheader)
		F.ODBC.con!rst.MoveNext

F.Intrinsic.Control.Loop
F.ODBC.con!rst.Close


F.Intrinsic.Control.CallSub(Routeraddrecord)

F.Intrinsic.Control.CallSub(Routerheader)




F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("RouterHeader2_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.RouterHeader2.End

Program.Sub.RouterLine2.Start
F.Intrinsic.Control.SetErrorHandler("RouterLine2_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSql.Declare(String)

V.local.lRtrCount.Declare(Long)
V.Local.ilines.Declare(Long)
V.Local.ssqllines.Declare(String)
V.Local.ssqllines2.Declare(String)


'load the udt for the header upload

'F.Intrinsic.Debug.InvokeDebugger
'
'F.Intrinsic.Debug.Stop


F.Intrinsic.String.Build("Select * from  ROUTER_LINE  where ROUTER  in {0}",V.global.sRouterList,V.Local.sSql)
F.ODBC.Connection!con.OpenLocalRecordsetRO("rstlines1",V.Local.sSql)


F.Intrinsic.Control.DoUntil(V.ODBC.con!rstlines1.EOF,=,True)
	F.Intrinsic.Math.Add(V.local.lRtrCount,1,V.local.lRtrCount)
	F.ODBC.con!rstLINES1.MoveNext
F.Intrinsic.Control.Loop

F.Intrinsic.Math.sub(V.local.lRtrCount,1,V.local.lRtrCount)
V.uGlobal.uRtr.Redim(0,V.local.lRtrCount)

F.ODBC.con!rstLINES1.Movefirst


F.Intrinsic.Control.DoUntil(V.ODBC.con!rstlines1.EOF,=,True)

		V.uGlobal.uRtr(v.Local.ilines)!Number.Set(V.ODBC.con!rstlines1.FieldValTrim!ROUTER)
		V.uGlobal.uRtr(v.Local.ilines)!Desc.Set(V.ODBC.con!rstlines1.FieldValTrim!DESC_RT_LINE)
		V.uGlobal.uRtr(v.Local.ilines)!Sequence.Set(V.ODBC.con!rstlines1.FieldValTrim!LINE_ROUTER)

		F.Intrinsic.Control.If(V.ODBC.con!rstlines1.FieldValTrim!LMO,=,"O")
			V.uglobal.uRtr(v.local.ilines)!Part.set(V.ODBC.con!rstlines1.fieldvaltrim!PART_WC_OUTSIDE)
		F.Intrinsic.Control.ElseIf(V.ODBC.con!rstlines1.FieldValTrim!LMO,=,"M")
			V.uglobal.uRtr(v.local.ilines)!Part.set(V.ODBC.con!rstlines1.fieldvaltrim!PART_WC_OUTSIDE)
		F.Intrinsic.Control.ElseIf(V.ODBC.con!rstlines1.FieldValTrim!LMO,=,"L")
			V.uglobal.uRtr(v.local.ilines)!Workcenter.set(V.ODBC.con!rstlines1.fieldvaltrim!PART_WC_OUTSIDE)
		'machine
		F.Intrinsic.Control.EndIf

		V.uGlobal.uRtr(v.Local.ilines)!LMO.Set(V.ODBC.con!rstlines1.FieldValTrim!LMO)
		V.uGlobal.uRtr(v.Local.ilines)!Seq_Desc.Set(V.ODBC.con!rstlines1.FieldValTrim!DESC_RT_LINE)
		V.uGlobal.uRtr(v.Local.ilines)!Setup.Set(V.ODBC.con!rstlines1.FieldValTrim!SET_UP)
		V.uGlobal.uRtr(v.Local.ilines)!RunTime.Set(V.ODBC.con!rstlines1.FieldValTrim!RUN_TIME)
		V.uGlobal.uRtr(v.Local.ilines)!Operation.Set(V.ODBC.con!rstlines1.FieldValTrim!OPERATION)
		V.uGlobal.uRtr(v.Local.ilines)!Rate.Set(V.ODBC.con!rstlines1.FieldValTrim!RATE)
		V.uGlobal.uRtr(v.Local.ilines)!Frequency.Set(V.ODBC.con!rstlines1.FieldValTrim!FREQUENCY)
		V.uGlobal.uRtr(v.Local.ilines)!overlap.Set(V.ODBC.con!rstlines1.FieldValTrim!OVERLAP)
		V.uGlobal.uRtr(v.Local.ilines)!WCFact.Set(V.ODBC.con!rstlines1.FieldValTrim!WC_FACTOR)
		V.uGlobal.uRtr(v.Local.ilines)!Crew.Set(V.ODBC.con!rstlines1.FieldValTrim!CREW_SIZE)
		V.uGlobal.uRtr(v.Local.ilines)!Lead.Set(V.ODBC.con!rstlines1.FieldValTrim!LEAD_TIME)
		V.uGlobal.uRtr(v.Local.ilines)!Sort.Set(V.ODBC.con!rstlines1.FieldValTrim!SORT_CODE)
		V.uGlobal.uRtr(v.Local.ilines)!Min_Flag.Set(V.ODBC.con!rstlines1.FieldValTrim!FLAG_MINIMUM)
		V.uGlobal.uRtr(v.Local.ilines)!Min_Out.Set(V.ODBC.con!rstlines1.FieldValTrim!AMT_MINIMUM)
		V.uGlobal.uRtr(v.Local.ilines)!Locn.Set(V.ODBC.con!rstlines1.FieldValTrim!PART_LOCN)
		V.uGlobal.uRtr(V.lOCAL.ilines)!Tooling.Set(V.ODBC.con!rsTLINES1.FieldValTrim!TOOLING_SEQ)
		V.uGlobal.uRtr(V.Local.ilines)!Signoff_Type.Set(V.ODBC.con!rstlines1.FieldValTrim!SIGNOFF_TYPE)
		V.uGlobal.uRtr(V.lOCAL.ilines)!Signoff_User.Set(V.ODBC.con!rstLINES1.FieldValTrim!SIGNOFF_GRPUSR)

	'get teh descriptions from the router_desc table
	F.Intrinsic.String.Build("select DESC_ROUTER_1, DESC_ROUTER_2, DESC_ROUTER_3 from V_ROUTER_DESC where ROUTER = '{0}'",V.ODBC.con!rstlines1.FieldValTrim!ROUTER,V.Local.ssqllines2)
	F.ODBC.Connection!con.OpenLocalRecordsetRO("rstlines2",V.Local.ssqllines2)
	F.Intrinsic.Control.If(V.ODBC.con!rstlines2.EOF,=,False)
		V.uGlobal.uRtr(v.Local.ilines)!Desc1.Set(V.ODBC.con!rstLINES2.FieldValTrim!DESC_ROUTER_1)
		V.uGlobal.uRtr(v.Local.ilines)!Desc2.Set(V.ODBC.con!rstLINES2.FieldValTrim!DESC_ROUTER_2)
		V.uGlobal.uRtr(v.Local.ilines)!Desc3.Set(V.ODBC.con!rstLINES2.FieldValTrim!DESC_ROUTER_3)
	F.Intrinsic.Control.EndIf
	F.ODBC.con!rstlines2.Close
	F.Intrinsic.Math.Add(V.Local.ilines,1,V.Local.ilines)
	F.ODBC.con!rstLINES1.MoveNext
F.Intrinsic.Control.Loop
F.ODBC.con!rstlines1.Close

'call the subroutines to upload the lines information
F.Intrinsic.Control.CallSub(Routeraddrecord)
F.Intrinsic.Control.CallSub(Routerline)


F.Intrinsic.String.Build("delete  from GLOBAL{0}.Router_header where ROUTER in {1} ",V.global.utargetcompcode,V.global.sRouterList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)
F.Intrinsic.String.Build("insert  into GLOBAL{0}.Router_header select * from GLOBAL{1}.Router_header where ROUTER in {2} ",V.global.utargetcompcode,V.global.uCurrentCompanyCode,V.global.sRouterList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("update GLOBAL{0}.Router_header set Customer = '{1}' where Router  in {2} ",V.global.utargetcompcode,V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sRouterList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)


F.Intrinsic.String.Build("delete  from GLOBAL{0}.Router_line where ROUTER in {1} ",V.global.utargetcompcode,V.global.sRouterList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)
F.Intrinsic.String.Build("insert  into GLOBAL{0}.Router_line select * from GLOBAL{1}.Router_line where ROUTER in {2} ",V.global.utargetcompcode,V.global.uCurrentCompanyCode,V.global.sRouterList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("RouterLine2_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.RouterLine2.End

Program.Sub.JobCostHeader.Start
F.Intrinsic.Control.SetErrorHandler("JobCostHeader_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


V.Local.sSql.Declare(String)
V.Local.ix.Declare(Long)
V.Local.sWO.Declare(String)
V.Local.filename.Declare(String)
V.Local.filedir.Declare(String)
V.Local.shold.Declare(String)

V.uGlobal.uJHeader.redim(-1,-1)

F.Intrinsic.String.Build("select * from job_header where job + suffix in {0} ",V.global.sJobList,V.Local.sSql)


F.ODBC.Connection!con.OpenLocalRecordsetRO("rst",V.Local.sSql)
F.Intrinsic.Control.If(V.ODBC.con!rst.EOF,=,False)
	F.Intrinsic.Variable.LoadUDTFromRecordset("con","rst","uglobal.uJHeader","false",10000)
F.Intrinsic.Control.EndIf
F.ODBC.con!rst.Close


F.intrinsic.control.for(V.Local.ix,V.uglobal.uJHeader.lbound,V.uglobal.uJHeader.ubound,1)
''JOB
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!JOB," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!JOB.set(V.local.shold)

''SUFFIX
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!SUFFIX," ",3,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,3,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!SUFFIX.set(V.local.shold)

'PART
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!PART," ",20,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,20,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!PART.set(V.local.shold)

''LOCATION
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!LOCATION," ",2,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,2,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!LOCATION.set(V.local.shold)

'ROUTER
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!ROUTER," ",20,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,20,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!ROUTER.set(V.local.shold)

'DESCRIPTION
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!DESCRIPTION," ",30,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,30,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!DESCRIPTION.set(V.local.shold)

'CUSTOMER
	F.Intrinsic.String.RPad(V.Screen.frmcrosscopy!txtTcmpy.MetaData0," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!CUSTOMER.set(V.local.shold)

'CUSTOMER_PO
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!CUSTOMER_PO," ",20,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,20,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!CUSTOMER_PO.set(V.local.shold)

'Run Quantity
	F.Intrinsic.String.Format(V.uGlobal.uJHeader(V.Local.ix)!QTY_ORDER,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!QTY_ORDER.set(V.local.shold)

'DATE_OPENED
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!DATE_OPENED," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!DATE_OPENED.set(V.local.shold)

'DATE_DUE
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!DATE_DUE," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!DATE_DUE.set(V.local.shold)

'DATE_START
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!DATE_START," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!DATE_START.set(V.local.shold)

'DATE_START_OTHER
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!DATE_START_OTHER," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!DATE_START_OTHER.set(V.local.shold)

'COMMENTS_1
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!COMMENTS_1," ",70,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,70,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!COMMENTS_1.set(V.local.shold)

'COMMENTS_2
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!COMMENTS_2," ",70,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,70,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!COMMENTS_2.set(V.local.shold)

'USERCODE
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!USERCODE," ",30,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,30,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!USERCODE.set(V.local.shold)

'QTY_COMPLETED
	F.Intrinsic.String.Format(V.uGlobal.uJHeader(V.Local.ix)!QTY_COMPLETED,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!QTY_COMPLETED.set(V.local.shold)

'SALESPERSON
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!SALESPERSON," ",3,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,3,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!SALESPERSON.set(V.local.shold)

'DATE_CLOSED
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!DATE_CLOSED," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!DATE_CLOSED.set(V.local.shold)

'PRODUCT_LINE
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!PRODUCT_LINE," ",2,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,2,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!PRODUCT_LINE.set(V.local.shold)

'AMT_PRICE_PER_UNIT
	F.Intrinsic.String.Format(V.uGlobal.uJHeader(V.Local.ix)!AMT_PRICE_PER_UNIT,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!AMT_PRICE_PER_UNIT.set(V.local.shold)


'QTY_CUSTOMER
	F.Intrinsic.String.Format(V.uGlobal.uJHeader(V.Local.ix)!QTY_CUSTOMER,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!QTY_CUSTOMER.set(V.local.shold)

'PART_DESCRIPTION
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!PART_DESCRIPTION," ",30,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,30,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!PART_DESCRIPTION.set(V.local.shold)

'PRIORITY
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!PRIORITY," ",3,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,3,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!PRIORITY.set(V.local.shold)

'PROJECT
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!PROJECT," ",7,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,7,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!PROJECT.set(V.local.shold)

'COMMENTS_3
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!COMMENTS_3," ",70,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,70,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!COMMENTS_3.set(V.local.shold)

'PARENT_WO
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!PARENT_WO," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!PARENT_WO.set(V.local.shold)

'PARENT_SUFFIX_PARENT
	F.Intrinsic.String.RPad(V.uGlobal.uJHeader(V.Local.ix)!PARENT_SUFFIX_PARENT," ",3,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,3,V.Local.shold)
	V.uGlobal.uJHeader(V.Local.ix)!PARENT_SUFFIX_PARENT.set(V.local.shold)
F.Intrinsic.Control.Next(V.Local.ix)

F.Intrinsic.Control.For(V.Local.ix,V.uGlobal.uJHeader.LBound,V.uglobal.uJHeader.UBound,1)
'	F.Intrinsic.UI.ChangeWaitStatus("Adding WO",V.Local.ix,V.uGlobal.uJHeader.lbound,V.uGlobal.uJHeader.UBound)
	F.Intrinsic.Control.If(V.uGlobal.uJHeader(v.Local.ix)!Job,<>,"")
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJHeader(v.Local.ix)!JOB,V.uGlobal.uJHeader(v.Local.ix)!SUFFIX,V.uGlobal.uJHeader(v.Local.ix)!PART,V.uGlobal.uJHeader(v.Local.ix)!LOCATION,V.uGlobal.uJHeader(v.Local.ix)!ROUTER,V.uGlobal.uJHeader(v.Local.ix)!DESCRIPTION,V.local.sWO)
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJHeader(v.Local.ix)!CUSTOMER,V.uGlobal.uJHeader(v.Local.ix)!CUSTOMER_PO,V.uGlobal.uJHeader(v.Local.ix)!QTY_ORDER,V.uGlobal.uJHeader(v.Local.ix)!DATE_OPENED,V.uGlobal.uJHeader(v.Local.ix)!DATE_DUE,V.uGlobal.uJHeader(v.Local.ix)!DATE_START,V.local.sWO)
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJHeader(v.Local.ix)!DATE_START_OTHER,V.uGlobal.uJHeader(v.Local.ix)!COMMENTS_1,V.uGlobal.uJHeader(v.Local.ix)!COMMENTS_2,V.uGlobal.uJHeader(v.Local.ix)!USERCODE,V.uGlobal.uJHeader(v.Local.ix)!QTY_COMPLETED,V.uGlobal.uJHeader(v.Local.ix)!SALESPERSON,V.local.sWO)
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJHeader(v.Local.ix)!DATE_CLOSED,V.uGlobal.uJHeader(v.Local.ix)!PRODUCT_LINE,V.uGlobal.uJHeader(v.Local.ix)!AMT_PRICE_PER_UNIT,V.uGlobal.uJHeader(v.Local.ix)!QTY_CUSTOMER,V.uGlobal.uJHeader(v.Local.ix)!PART_DESCRIPTION,V.uGlobal.uJHeader(v.Local.ix)!PRIORITY,V.local.sWO)
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJHeader(v.Local.ix)!PROJECT,V.uGlobal.uJHeader(v.Local.ix)!COMMENTS_3,V.uGlobal.uJHeader(v.Local.ix)!PARENT_WO,V.uGlobal.uJHeader(v.Local.ix)!PARENT_SUFFIX_PARENT,V.local.sWO)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.ix)

F.Intrinsic.Control.If(V.Local.sWO,<>,"")
	f.Global.General.overridecompany(v.global.utargetcompcode)
	V.Local.filename.Set("JBMDLA.TXT")
	'output file
	F.Intrinsic.String.Concat(V.Caller.FilesDir,"\",V.Local.filename,V.Local.filedir)
	F.Intrinsic.File.String2File(V.Local.filedir,V.Local.sWO)
'F.Intrinsic.Debug.InvokeDebugger
'F.Intrinsic.Debug.Stop

'	F.Global.General.CallWrappersync(50,"UPLJBMUL/A/L")
	F.Global.General.CallWrappersync(6017,"50!*!A")
	
'	F.Global.General.CallWrappersync(51,V.global.utargetcompcode,"UPLJBMUL/A/X")

	f.Global.General.overridecompany(v.global.ucurrentcompanycode)



	F.Intrinsic.String.Build("delete  from GLOBAL{0}.job_header where job + suffix in {1} ",V.global.utargetcompcode,V.global.sJobList,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
	F.Intrinsic.String.Build("insert  into GLOBAL{0}.job_header select * from GLOBAL{1}.job_header where job + suffix in {2} ",V.global.utargetcompcode,V.global.uCurrentCompanyCode,V.global.sJobList,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)

'	F.Intrinsic.String.Build("update GLOBAL{0}.job_header set Customer = '{1}' where job + suffix  in {2} ",V.global.utargetcompcode,V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sJobList,V.Local.sSql)
	
	'changed code to reset costs 03/30/2017
	F.Intrinsic.String.Build("update GLOBAL{0}.job_header set Customer = '{1}',QTY_COMPLETED=0 ,DATE_CLOSED='000000' ,AMT_SALES=0 ,AMT_MATERIAL=0 ,NUM_HOURS=0 ,AMT_LABOR=0 ,AMT_OVERHEAD=0 ,AMT_PARTIAL_SHPMNT=0 ,FREIGHT=0 ,PARTIAL_FREIGHT=0 ,DATE_SHIP_1='000000' , DATE_SHIP_2='000000',DATE_SHIP_3='000000',DATE_SHIP_4 ='000000',QTY_SHIP_1 =0, QTY_SHIP_2=0,QTY_SHIP_3=0,QTY_SHIP_4=0 ,OTHER=0 ,PARTIAL_OTHER=0 where job + suffix  in {2} ",V.global.utargetcompcode,V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sJobList,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
F.Intrinsic.Control.EndIf



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("JobCostHeader_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.JobCostHeader.End

Program.Sub.JobCostOperation.Start
F.Intrinsic.Control.SetErrorHandler("JobCostOperation_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)
V.Local.sSql.Declare(String)
V.Local.ix.Declare(Long)
V.Local.sWO.Declare(String)
V.Local.filename.Declare(String)
V.Local.filedir.Declare(String)
V.Local.shold.Declare(String)

V.uGlobal.uJobOUPL.redim(-1,-1)

F.Intrinsic.String.Build("select * from job_operations where job + suffix in {0} ",V.global.sJobList,V.Local.sSql)

'F.Intrinsic.UI.Msgbox(V.Local.sSql)

F.ODBC.Connection!con.OpenLocalRecordsetRO("rst1",V.Local.sSql)
F.Intrinsic.Control.If(V.ODBC.con!rst1.EOF,=,False)
	F.Intrinsic.Variable.LoadUDTFromRecordset("con","rst1","uGlobal.uJobOUPL","false",10000)
F.Intrinsic.Control.EndIf

F.ODBC.con!rst1.Close

F.intrinsic.control.for(V.Local.ix,V.uglobal.uJobOUPL.LBound,V.uglobal.uJobOUPL.UBound,1)
'' JOB
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!JOB," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!JOB.set(V.local.shold)

''SUFFIX
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!SUFFIX," ",3,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,3,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!SUFFIX.set(V.local.shold)

'SEQ
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!SEQ," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!SEQ.set(V.local.shold)

'OPERATION
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!OPERATION," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!OPERATION.set(V.local.shold)

'FLAG_SET_UP
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!FLAG_SET_UP," ",1,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,1,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!FLAG_SET_UP.set(V.local.shold)

'LMO
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!LMO," ",1,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,1,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!LMO.set(V.local.shold)


'DESCRIPTION
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!DESCRIPTION," ",30,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,30,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!DESCRIPTION.set(V.local.shold)


'UM
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!UM," ",2,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,2,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!UM.set(V.local.shold)

'PWC
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!PWC," ",20,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,20,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!PWC.set(V.local.shold)

'ROUTER
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!ROUTER," ",20,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,20,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!ROUTER.set(V.local.shold)



'ROUTER_SEQ
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!ROUTER_SEQ," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!ROUTER_SEQ.set(V.local.shold)


'SETUP
	F.Intrinsic.String.Format(V.uglobal.uJobOUPL(V.Local.ix)!SETUP,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!SETUP.set(V.local.shold)

'RATE_PIECE
	F.Intrinsic.String.Format(V.uglobal.uJobOUPL(V.Local.ix)!RATE_PIECE,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!RATE_PIECE.set(V.local.shold)

'BURDEN RATE
	F.Intrinsic.String.Format(V.uglobal.uJobOUPL(V.Local.ix)!RATE_BURDEN,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!RATE_BURDEN.set(V.local.shold)

'HOURS_ESTIMATED
	F.Intrinsic.String.Format(V.uglobal.uJobOUPL(V.Local.ix)!HOURS_ESTIMATED,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!HOURS_ESTIMATED.set(V.local.shold)


'DATE_START
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!DATE_START," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!DATE_START.set(V.local.shold)

'DATE_DUE
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!DATE_DUE," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!DATE_DUE.set(V.local.shold)

'DATE_PO_ORDER
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!DATE_PO_ORDER," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!DATE_PO_ORDER.set(V.local.shold)

'RATE
	F.Intrinsic.String.Format(V.uglobal.uJobOUPL(V.Local.ix)!RATE,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!RATE.set(V.local.shold)


'CODE_SORT_OPER
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!CODE_SORT_OPER," ",20,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,20,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!CODE_SORT_OPER.set(V.local.shold)


'PROJ_GROUP
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!PROJ_GROUP," ",6,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,6,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!PROJ_GROUP.set(V.local.shold)


'TASK_SIGNOFF_USER
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!TASK_SIGNOFF_USER," ",8,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,8,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!TASK_SIGNOFF_USER.set(V.local.shold)


'TASK_COMP_REQ
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!TASK_COMP_REQ," ",1,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,1,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!TASK_COMP_REQ.set(V.local.shold)

'NO_ROUTER_UPDATE
	F.Intrinsic.String.RPad(V.uglobal.uJobOUPL(V.Local.ix)!NO_ROUTER_UPDATE," ",1,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,1,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!NO_ROUTER_UPDATE.set(V.local.shold)

''OVERLAP
	F.Intrinsic.String.Format(V.uglobal.uJobOUPL(V.Local.ix)!OVERLAP,"0.0000",V.Local.shold)
	F.Intrinsic.String.LPad(V.Local.shold,"0",16,V.Local.shold)
	F.Intrinsic.String.Left(V.Local.shold,16,V.Local.shold)
	V.uglobal.uJobOUPL(V.Local.ix)!OVERLAP.set(V.local.shold)

F.Intrinsic.Control.Next(V.Local.ix)

F.Intrinsic.Control.For(V.Local.ix,V.uGlobal.uJobOUPL.LBound,V.uglobal.uJobOUPL.UBound,1)
'	F.Intrinsic.UI.ChangeWaitStatus("Adding JOB OPERATIONS",V.Local.ix,V.uGlobal.uJobOUPL.lbound,V.uGlobal.uJobOUPL.UBound)
	F.Intrinsic.Control.If(V.uGlobal.uJobOUPL(v.Local.ix)!Job,<>,"")
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJobOUPL(v.Local.ix)!JOB,V.uGlobal.uJobOUPL(v.Local.ix)!SUFFIX,V.uGlobal.uJobOUPL(v.Local.ix)!SEQ,V.uGlobal.uJobOUPL(v.Local.ix)!OPERATION,V.uGlobal.uJobOUPL(v.Local.ix)!FLAG_SET_UP,V.uGlobal.uJobOUPL(v.Local.ix)!LMO,V.local.sWO)
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJobOUPL(v.Local.ix)!DESCRIPTION,V.uGlobal.uJobOUPL(v.Local.ix)!UM,V.uGlobal.uJobOUPL(v.Local.ix)!PWC,V.uGlobal.uJobOUPL(v.Local.ix)!ROUTER,V.uGlobal.uJobOUPL(v.Local.ix)!ROUTER_SEQ,V.uGlobal.uJobOUPL(v.Local.ix)!SETUP,V.local.sWO)
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJobOUPL(v.Local.ix)!RATE_PIECE,V.uGlobal.uJobOUPL(v.Local.ix)!RATE_BURDEN,V.uGlobal.uJobOUPL(v.Local.ix)!HOURS_ESTIMATED,V.uGlobal.uJobOUPL(v.Local.ix)!DATE_START,V.uGlobal.uJobOUPL(v.Local.ix)!DATE_DUE,V.uGlobal.uJobOUPL(v.Local.ix)!DATE_PO_ORDER,V.local.sWO)
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJobOUPL(v.Local.ix)!RATE,V.uGlobal.uJobOUPL(v.Local.ix)!CODE_SORT_OPER,V.uGlobal.uJobOUPL(v.Local.ix)!PROJ_GROUP,V.uGlobal.uJobOUPL(v.Local.ix)!TASK_SIGNOFF_USER,V.uGlobal.uJobOUPL(v.Local.ix)!TASK_COMP_REQ,V.uGlobal.uJobOUPL(v.Local.ix)!NO_ROUTER_UPDATE,V.local.sWO)
			F.Intrinsic.String.Concat(V.Local.sWO,V.uGlobal.uJobOUPL(v.Local.ix)!OVERLAP,V.Ambient.NewLine,V.local.sWO)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Next(V.Local.ix)

F.Intrinsic.Control.If(V.Local.sWO,<>,"")
	f.Global.General.overridecompany(v.global.utargetcompcode)
	V.Local.filename.Set("JOBCOST.TXT")
	'output file
	F.Intrinsic.String.Concat(V.Caller.FilesDir,"\",V.Local.filename,V.Local.filedir)
	F.Intrinsic.File.String2File(V.Local.filedir,V.Local.sWO)
	
	
	F.Global.General.CallWrappersync(50,"UPLJOBST/A/L")
'	F.Intrinsic.Task.LaunchGSSSync("UPL001A","-u","UPLJOBST")

'	F.Global.General.CallWrappersync(51,v.global.utargetcompcode,"UPLJOBST/X")
	f.Global.General.overridecompany(v.global.ucurrentcompanycode)

	F.Intrinsic.String.Build("delete  from GLOBAL{0}.job_operations where job + suffix in {1} ",V.global.utargetcompcode,V.global.sJobList,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
	F.Intrinsic.String.Build("insert  into GLOBAL{0}.job_operations select * from GLOBAL{1}.job_operations where job + suffix in {2} ",V.global.utargetcompcode,V.global.uCurrentCompanyCode,V.global.sJobList,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
	

	'UNITS_COMPLETE=0 ,PERCENT_COMPLETE =0 ,UNITS_SCRAP=0  ,HOURS_ACTUAL =0 ,DOLLARS_ACTUAL =0 ,DATE_COMPLETED ='000000' ,FLAG_CLOSED = ' '
	'changed code to reset costs 03/30/2017
	F.Intrinsic.String.Build("update GLOBAL{0}.job_operations set UNITS_COMPLETE=0 ,PERCENT_COMPLETE =0 ,UNITS_SCRAP=0  ,HOURS_ACTUAL =0 ,DOLLARS_ACTUAL =0 ,DATE_COMPLETED ='000000' ,FLAG_CLOSED = ' ' where job + suffix  in {1} ",V.global.utargetcompcode,V.global.sJobList,V.Local.sSql)
	F.ODBC.Connection!con.Execute(V.Local.sSql)
F.Intrinsic.Control.EndIf



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("JobCostOperation_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.JobCostOperation.End

Program.Sub.LoaduOrders.Start

F.Intrinsic.Control.SetErrorHandler("LoaduOrder_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'This was switched to run ORDUPL webimporter for Unex instead of UPLSALES and ORDADLN.

V.Local.i.Declare(Long)
V.Local.iRet.Declare(Float)
V.Local.sRet.Declare(String)
V.Local.sSql.Declare(String)
V.Local.iUB.Declare(String)
V.Local.iPC.Declare(Long)
V.Local.iPC2.Declare(Long)
V.Local.sOrdinal.Declare(String)
V.Local.iOrder.Declare(Long)

V.uGlobal.uOrder.redim(-1,-1)

'F.Intrinsic.Debug.InvokeDebugger
'F.Intrinsic.Debug.Stop


F.Intrinsic.String.Build("select * from ORDER_HEADER where ORDER_NO + record_no in {0} ",V.global.sOrderLnList,V.Local.sSql)


F.ODBC.Connection!con.OpenLocalRecordsetRO("rst1",V.Local.sSql)
F.Intrinsic.Control.If(V.ODBC.con!rst1.EOF,=,False)
	F.Intrinsic.Variable.LoadUDTFromRecordset("con","rst1","uGlobal.uOrder","false",10000)
F.Intrinsic.Control.Else
	F.Intrinsic.UI.Msgbox("Order not found")
	F.ODBC.con!rst1.Close
	F.Intrinsic.Control.End

F.Intrinsic.Control.EndIf
F.ODBC.con!rst1.Close

V.uGlobal.uOrdLines.redim(-1,-1)

F.Intrinsic.String.Build("Select * from order_Lines where ORDER_NO + record_no in {0} ",V.global.sOrderLnList,V.Local.sSql)
F.ODBC.Connection!con.OpenLocalRecordsetRO("rst1",V.Local.sSql)
F.Intrinsic.Control.If(V.ODBC.con!rst1.EOF,=,False)
	F.Intrinsic.Variable.LoadUDTFromRecordset("con","rst1","uGlobal.uOrdLines",False,10000)
F.Intrinsic.Control.EndIf
F.ODBC.con!rst1.Close


'Build string that will be passed to lib file
F.Intrinsic.Control.For(V.Local.i,V.uGlobal.uOrder.LBound,V.uGlobal.uOrder.UBound,1)
	F.Intrinsic.String.Build("{0}*!*{1}",V.Global.sOrders,V.uGlobal.uOrder(v.Local.i)!Order_No.Trim,V.Global.sOrders)
F.Intrinsic.Control.Next(V.Local.i)

'.lib UDT Redim for uOrder
V.uGlobal.uOrders.Redim(0,V.uGlobal.uOrdLines.UBound)

'uOrders UDT is from .lib file UDT.

'Loop through ordlnscopy and copy necessary elements to the uOrder UDT that will be used for ORDUPL webimporter
F.Intrinsic.Control.For(V.Local.i,V.uGlobal.uOrdlines.LBound,V.uGlobal.uOrdlines.UBound,1)
	'Get correct ordinal position from uOrder(Header info)
	F.Intrinsic.Variable.UDTMultiSeek(V.uGlobal.uOrder!Order_No,V.uGlobal.uOrder(v.Local.i)!Order_No,V.Local.sOrdinal)
	F.Intrinsic.Control.If(V.Local.sOrdinal.Trim,<>,"")
		'iOrder is Index of current Order_No Info for Header Details that will go in .lib file
		V.Local.iOrder.Set(V.Local.sOrdinal.Long)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Debug.Stop
'Header info loaded referenced by "V.uGlobal.uOrder(v.Local.iOrder)!ELEMENT"
	'Customer from Header UDT
	V.uGlobal.uOrders(V.Local.iOrder)!Customer.Set(V.Screen.frmcrosscopy!txtTcmpy.MetaData0)
	V.uGlobal.uOrders(V.Local.iOrder)!Transaction.Set("O")
	V.uGlobal.uOrders(V.Local.iOrder)!Order_No.Set(V.uGlobal.uOrder(v.Local.i)!Order_No)

'Line info loaded
	'Part from Lines UDT
	V.uGlobal.uOrders(v.Local.i)!Part.Set(V.uGlobal.uOrdLines(v.Local.i)!Part)
	'Qty_Order from Lines UDT
	V.uGlobal.uOrders(v.Local.i)!Line_No.Set(V.uGlobal.uOrdLines(v.Local.i)!Record_No)
	'Record_No =
	V.uGlobal.uOrders(v.Local.i)!Qty_Order.Set(V.uGlobal.uOrdLines(v.Local.i)!QTY_ORDERED)
	
F.Intrinsic.Control.Next(V.Local.i)



F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("LoaduOrder_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_UNEX_UPLOAD_PLA.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf



Program.Sub.LoaduOrders.End

Program.Sub.OrdLIb.Start

F.Intrinsic.Control.SetErrorHandler("Upload_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

'Final Formatting of UDT
'When Calling this SUB, pass the FQP of file(v.args.File used in this Sub) that it will be written to, this should be based on the GSSPARAM.txt file setup for Company.
'REQUIRED FILEDS ARE NOTED WITH "'***REQUIRED***
V.Local.i.Declare(Float)
V.Local.sRet.Declare(String)
V.Local.sTemp.Declare(String)
V.Local.sFileContents.Declare(String)
V.Local.sParams.Declare(String)
V.Local.sTime.Declare(String)
V.Local.sDate.Declare(String)
V.Local.sFile.Declare(String)
V.Local.bExists.Declare(Boolean)
V.Local.sRet2.Declare(String)
V.Local.sOrders.Declare(String)
V.Local.iOrder.Declare(Long)
V.Local.sSql.Declare(String)

'Exit lib file if UDT is NOT loaded
F.Intrinsic.Control.If(V.uGlobal.uOrders.UBound,<,0)
	F.Intrinsic.Control.ExitSub
F.Intrinsic.Control.EndIf
'Passed string of orders
F.Intrinsic.String.Split(V.Args.sOrders,"*!*",V.Local.sOrders)


'Loop through uOrders and format before calling upload
'One each element , clear sRet first, this is incase that element is not used.
'When formatting each element of the udt, return the final formatted element to 'v.local.sRet', it is already programmed to use that as the variable when building the file

F.Intrinsic.Control.For(V.Local.iOrder,1,V.Local.sOrders.UBound,1)
'Change waity status bar
'	F.Intrinsic.UI.ChangeWaitStatus("Uploading Sales Orders...Please Wait",V.Local.iOrder,1,V.Local.sOrders.UBound)
	F.Intrinsic.Control.For(V.Local.i,V.uGlobal.uOrders.LBound,V.uGlobal.uOrders.UBound,1)
		F.intrinsic.control.if(V.Local.sOrders(v.Local.iOrder).Trim,=,V.uGlobal.uOrders(v.Local.i)!Order_no.Trim)

			'***FIELD,Length,StartPosition-Description if Availab
			
			'Transaction, 1,1 Transaction Code:  ""O"" for sales order or ""Q"" for Quote    '***REQUIRED***
			V.Local.sTemp.Set("O")
			'Customer, 7,2 Customer Number: '***REQUIRED*** unless using ordupmnu to choose customer id.
			'F.Intrinsic.String.RPad(V.uGlobal.uOrders(v.Local.i)!Customer," ",7,V.Local.sRet)
			F.Intrinsic.String.RPad(V.Screen.frmcrosscopy!txtTcmpy.MetaData0," ",7,V.Local.sRet)
			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			'OrderNo, 7,9 If AutoNumbering Turned on can be left blank, otherwise a required field with leading zeros
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Order_No)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",15,V.Local.sTemp)
			'Freight,10,16 Freight amount  8.2  Must enter numeric values with a filler of zeroes- do not use spaces. Example entry of 2.50     0000000250
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",25,V.Local.sTemp)
			'Tax Freight Flag,1,26 Flag Y N or blank
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",26,V.Local.sTemp)
			'Freight Per Piece,1,27 Flag Y N or blank
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",27,V.Local.sTemp)
			'Order Date Due,8,28 CCYYMMDD   Example entry of Aug 5 2006     20060806
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",35,V.Local.sTemp)
			'Order Date,8,36 CCYYMMDD   Example entry of Aug 5 2006     20060806
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",43,V.Local.sTemp)
			'User 1 Header,30,44 User Field for Header up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",73,V.Local.sTemp)
			'User Field 2 Header,30,74 User Field for Header up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",103,V.Local.sTemp)
			'User Field 3 Header,30,104 User Field for Header up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!Header_User3.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",133,V.Local.sTemp)
			'User Field 4 Header,30,134 User Field for Header up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!Header_User4.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",163,V.Local.sTemp)
			'User Field 5 Header,30,164 User Field for Header up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!Header_User5.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",193,V.Local.sTemp)
			'UserId,8,194 User Field for Header up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",201,V.Local.sTemp)
			'CustomerPO,15,202UserFieldforHeaderupto30characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",231,V.Local.sTemp)
			'Filler_1,15,217,Not Used- Leave Blank

			'Freight_CurrFlag,1,232,Y N or blank
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",232,V.Local.sTemp)
			'Data Type,1,233,"""S"" for shipping data"
			V.Local.sRet.Set("S")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",233,V.Local.sTemp)
			'Ship Via,20,234
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!SHIP_VIA,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",253,V.Local.sTemp)
			'Carrier,6,254
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",259,V.Local.sTemp)
			'Ship To Name,30,260
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Ship_To_Name)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",289,V.Local.sTemp)
			'Ship To Address 1,30,290
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Ship_To_Address1)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",319,V.Local.sTemp)
			'Ship To Address 2,30,320
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Ship_To_Address2)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",349,V.Local.sTemp)
			'Ship To Address 3,30,350
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Ship_To_Address3)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",379,V.Local.sTemp)
			'Ship To City,25,380
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Ship_To_City)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",404,V.Local.sTemp)
			'Ship To State,2,405
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Ship_To_State)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",406,V.Local.sTemp)
			'Ship To Zip,13,407
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Ship_To_Zip)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",419,V.Local.sTemp)
			'Ship To Country,3,420
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!Ship_To_Country)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",422,V.Local.sTemp)
			'ShipToAttention,30,423
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",463,V.Local.sTemp)
			'filler in reusable area,11,453,Not in Use

			'Order type,1,464,"Regular = blank or spaces, Invoice = ""X"
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",464,V.Local.sTemp)
			'Order Discount Percentage,5,465,1.4 with an implied decimal (example:  45% would show as 04500 in the file
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",469,V.Local.sTemp)
			''Salesman,3,470,Salesman code within GSS
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",472,V.Local.sTemp)
			'PAY-METHOD , 2,473
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",474,V.Local.sTemp)
			'PAY-OWNER-NAME,30,475
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",504,V.Local.sTemp)
			'PAY-CC-TYPE ,2,505
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",506,V.Local.sTemp)
			'PAY-CC-NO , 25,507
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",531,V.Local.sTemp)
			'PAY-CC-LENGTH , 2,532
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",533,V.Local.sTemp)
			'PAY-CC-EXP-DT , 6,534
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",539,V.Local.sTemp)
			'PAY-CC-CVV , 7, 540
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",546,V.Local.sTemp)
			'PAY-CVV-LENGTH 1, 547 Numeric(1 or 0)
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",547,V.Local.sTemp)
			'Override auto numbering,1,548,"Populate with ""1"" will override the auto ordering number with the number provided in the order number above
			V.Local.sRet.Set("1")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",548,V.Local.sTemp)
			'Ship To Id,6,549,"Optional, must be valid for customer
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",554,V.Local.sTemp)
			'Mark Shipment,30,555
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",584,V.Local.sTemp)
			'Contact Name,30,585
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",614,V.Local.sTemp)
			'From Location, 2,615
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",701,V.Local.sTemp)
			'Filler_3,85,617,Not in Use

'F.Intrinsic.Debug.Stop
			'***Line Data***
			'Line Number,3,702,Not '***REQUIRED*** Valid input is 1 through 999
			V.Local.sRet.Set(V.uGlobal.uOrders(V.Local.i)!Line_No)
'			V.Local.sRet.Set("999")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",705,V.Local.sTemp)
			'Filler_Line,1,705,Not Used- Leave Blank

			'Qty Ordered,13,706,9.4; REQUIRED  Must enter numeric values with a filler or zeroes- do not enter spaces.  Example entry of 10  0000000100000
			V.Local.sRet.Set("")
				F.Intrinsic.String.LPad(V.uGlobal.uOrders(V.Local.i)!Qty_Order,"0",9,V.Local.sRet)
				F.Intrinsic.String.RPad(V.Local.sRet,"0",13,V.Local.sRet)
			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",718,V.Local.sTemp)
			'Weight,10,719,7.3 Must enter numeric values with a filler of zeroes- do not use spaces. Example entry of 2.50 would be 0000002500
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",728,V.Local.sTemp)
			'Unit Of Measure,2,729,Unit of Measure
			V.Local.sRet.Set(V.uGlobal.uOrders(v.Local.i)!UM)
			F.Intrinsic.String.RPad(V.Local.sRet," ",2,V.Local.sRet)

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",730,V.Local.sTemp)
			'*** 20 Char Part# - PART, 20,731'***REQUIRED***
			'Part Number,17,731,17 character part number
			'Part Rev,3,748,'***REQUIRED*** if using part rev and a revision exists OR if NOT using part revision and part is longer than 17 characters long.
			V.Local.sRet.Set("")
				
			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(V.local.i)!Part,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",768,V.Local.sTemp)
			'Filler,18,751,Not in Use - Leave Blank

			'Part Location,2,769,Location code
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",770,V.Local.sTemp)
			'Quoted Price,16,771,10.6; REQUIRED in company currency.
			'Make sure to fill in discount price even if no discounts apply.
			'Enter leading zeros - do not enter spaces.   Example of 12.50 0000000012500000
			V.Local.sRet.Set("")
			F.Intrinsic.String.IsInString(V.uGlobal.uOrders(v.Local.i)!Quote_Price,".",True,V.Local.bExists)
			F.Intrinsic.Control.If(V.Local.bExists,=,True)
				F.Intrinsic.String.Split(V.uGlobal.uOrders(v.Local.i)!Quote_Price.String,".",V.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet(0).Trim,"0",10,V.Local.sRet2)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sRet2,V.Local.sRet(1).Trim,V.Local.sRet2)
				F.Intrinsic.String.RPad(V.Local.sRet2.Trim,"0",16,V.Local.sRet)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}000000",V.uGlobal.uOrders(v.Local.i)!Quote_Price,V.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
			F.Intrinsic.Control.EndIf
				
			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",786,V.Local.sTemp)
			'OverRidePrice,16,787,10.6; any price over-rides in company currency.
			'Make sure to fill in discount price even if no discounts apply.
			'Enter leading zeros - do not enter spaces.   Example of 12.50 0000000012500000
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",802,V.Local.sTemp)
			'Cost,16,803,10.6; Cost of the Part in company currency.
			'Enter leading zeros - do not enter spaces.   Example of 12.50  000000125000
			V.Local.sRet.Set("")

			F.Intrinsic.String.IsInString(V.uGlobal.uOrders(v.Local.i)!Cost,".",True,V.Local.bExists)
			F.Intrinsic.Control.If(V.Local.bExists,=,True)
				F.Intrinsic.String.Split(V.uGlobal.uOrders(v.Local.i)!Cost.String,".",V.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet(0).Trim,"0",10,V.Local.sRet2)
				F.Intrinsic.String.Build("{0}{1}",V.Local.sRet2,V.Local.sRet(1).Trim,V.Local.sRet2)
				F.Intrinsic.String.RPad(V.Local.sRet2.Trim,"0",16,V.Local.sRet)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("{0}000000",V.uGlobal.uOrders(v.Local.i)!Cost,V.Local.sRet)
				F.Intrinsic.String.LPad(V.Local.sRet,"0",16,V.Local.sRet)
			F.Intrinsic.Control.EndIf

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",818,V.Local.sTemp)
			'DescriptionPart,30,819,Description of the Part Number Length of 30
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",848,V.Local.sTemp)
			'Product Line,3,849,Product Line of part number
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",851,V.Local.sTemp)
			'Line Order Date,8,852,CCYYMMDD  Example entry of Aug 5 2006     20060806
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",859,V.Local.sTemp)
			'Line Promise Date,8,860,CCYYMMDD  Example entry of Aug 5 2006     20060806
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",867,V.Local.sTemp)
			'User Field 1,30,868,User Field forLine up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",897,V.Local.sTemp)
			'User Field 2,30,898,User Field forLine up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",927,V.Local.sTemp)
			'User Field 3,30,928,User Field forLine up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",957,V.Local.sTemp)
			'User Field 4,30,958,User Field forLine up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",987,V.Local.sTemp)
			'User Field 5,30,988,User Field forLine up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1017,V.Local.sTemp)
			'Extention,16,1018,"10.6 in company currency.
			'Leading zeros - no spaces or commas.  Example of 1,250.21  0000001250210000
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1033,V.Local.sTemp)
			'No Delivery Before Date,8,1034,CCYYMMDD  Example entry of Aug 5 2006     20060806
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1041,V.Local.sTemp)
			'Must Deliver By Date,8,1042,CCYYMMDD  Example entry of Aug 5 2006     20060806
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1049,V.Local.sTemp)
			'vvv EXTRA TEXT vvv

			'DataType,1,1050,"""T"" for sales order text
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,"T",V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1050,V.Local.sTemp)
			'Text Line 1,30,1051,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE1.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1080,V.Local.sTemp)
			'Text Line 2,30,1081,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE2.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1110,V.Local.sTemp)
			'Text Line 3,30,1111,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE3.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1140,V.Local.sTemp)
			'Text Line 4,30,1141,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE4.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1170,V.Local.sTemp)
			'Text Line 5,30,1171,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE5.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1200,V.Local.sTemp)
			'Text Line 6,30,1201,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE6.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1230,V.Local.sTemp)
			'Text Line 7,30,1231,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE7.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1260,V.Local.sTemp)
			'Text Line 8,30,1261,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE8.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1290,V.Local.sTemp)
			'Text Line 9,30,1291,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE9.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1320,V.Local.sTemp)
			'Text Line 10,30,1321,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.uGlobal.uOrders(v.Local.i)!TEXT_LINE10.Trim,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1350,V.Local.sTemp)
			'Tax Status Flag,1,1351,"""E"" for exempt, ""T"" for taxable
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1351,V.Local.sTemp)
			'Line Type,1,1352,"""B"" for buyout, ""D"" for dropship, ""S"" for standard, ""C"" for consignment
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1352,V.Local.sTemp)
			'Negative Flag,1,1353,"""1"" = The order qty is negative for this line."
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1353,V.Local.sTemp)
			'Price Flag,1,1354,"""1"" = Accept zero price for this line.
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1354,V.Local.sTemp)
			'Sufficient Inventory Check,1,1355,"""1"" = Check to make sure inventory level is sufficient for this line.
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1355,V.Local.sTemp)
			'Survey No ,8,1356
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1363,V.Local.sTemp)
			'Router Val Flag 1,1364
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1364,V.Local.sTemp)
			'Router , 20,1365
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1384,V.Local.sTemp)
			'Router Seq ,6,1385
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1390,V.Local.sTemp)
			'STOCK-XREF, 1,1391
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1391,V.Local.sTemp)
			'Origin Order ,7,1392
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1398,V.Local.sTemp)
			'Origin Line,3,1399
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1401,V.Local.sTemp)
			'Length ,12,1402 Numeric(8,4)
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1413,V.Local.sTemp)
			'WIDTH ,12,1414 Numeric(8,4)
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1425,V.Local.sTemp)
			'CURR-FLAG ,1,1426
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1426,V.Local.sTemp)
			'Order Discount Percentage,5,1427,Order Line Discount format.
			'The field contains 1 leading digit and four decimals.  So 00500 would be entered for a 5% discount.
			V.Local.sRet.Set("")
				F.Intrinsic.Control.If(V.uGlobal.uOrders(v.Local.i)!Order_Disc_Pct.Trim,<>,"")
					F.Intrinsic.String.Split(V.uGlobal.uOrders(v.Local.i)!Order_Disc_Pct,".",V.Local.sRet)
					F.Intrinsic.String.RPad(V.Local.sRet(1),"0",4,V.Local.sRet)
					F.Intrinsic.String.LPad(V.Local.sRet,"0",5,V.Local.sRet)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1517,V.Local.sTemp)
			'Filler,86,1432,Not in Use - Leave Blank

			'***Extended Header Data***
			'Ship To International Flag,1,1518,"""Y"" for international address, ""N"" or spaces for domestic address
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1518,V.Local.sTemp)
			'Ship To Name,40,1519
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1558,V.Local.sTemp)
			'Ship To Address 1,40,1559
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1598,V.Local.sTemp)
			'Ship To Address 2,40,1599
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1638,V.Local.sTemp)
			'Ship To Address 3,40,1639
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1678,V.Local.sTemp)
			'Ship To Address 4,40,1679
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1718,V.Local.sTemp)
			'Ship To Address 5,40,1719
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1758,V.Local.sTemp)
			'Ship To City,25,1759
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1783,V.Local.sTemp)
			'Ship To State,2,1784
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1785,V.Local.sTemp)
			'Ship To Zip,13,1786
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1798,V.Local.sTemp)
			''Ship To Country,25,1799
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1823,V.Local.sTemp)
			'Ship To Attention,40,1824
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1863,V.Local.sTemp)
			'Bill To International Flag,1,1864,"""Y"" for international address, ""N"" or spaces for domestic address
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1864,V.Local.sTemp)
			'Bill To Name,40,1865
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1904,V.Local.sTemp)
			'Bill To Address 1,40,1905
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1943,V.Local.sTemp)
			'Bill To Address 2,40,1945
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",1984,V.Local.sTemp)
			'Bill To Address 3,40,1985
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2024,V.Local.sTemp)
			'Bill To Address 4,40,2025
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2064,V.Local.sTemp)
			'Bill To Address 5,40,2065
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2104,V.Local.sTemp)
			'Bill To City,25,2105
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2129,V.Local.sTemp)
			'Bill To State,2,2130
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2131,V.Local.sTemp)
			'Bill To Zip,13,2132
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2144,V.Local.sTemp)
			'Bill To Country,25,2145
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2169,V.Local.sTemp)
			'Bill To Attention,40,2170
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2209,V.Local.sTemp)
			'Contact's Email Address,100,2210
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2309,V.Local.sTemp)
			'Contact's Phone,20,2310
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2329,V.Local.sTemp)
			'***Sales Order Header Text Data***
			'Text Line 1,30,2330,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2359,V.Local.sTemp)
			'Text Line 2,30,2360,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2389,V.Local.sTemp)
			'Text Line 3,30,2390,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2419,V.Local.sTemp)
			'Text Line 4,30,2420,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2449,V.Local.sTemp)
			'Text Line 5,30,2450,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2479,V.Local.sTemp)
			'Text Line 6,30,2480,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2509,V.Local.sTemp)
			'Text Line 7,30,2510,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2539,V.Local.sTemp)
			'Text Line 8,30,2540,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2569,V.Local.sTemp)
			'Text Line 9,30,2570,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2599,V.Local.sTemp)
			'Text Line 10,30,2600,Additional Text for Line up to 30 characters
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2629,V.Local.sTemp)
			'Text Position,1,2630,"""H"" for header, ""F"" for footer
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2630,V.Local.sTemp)
			'Apply Text to Sales Order,1,2631,"""Y"" to apply, ""N"" for do not apply
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2631,V.Local.sTemp)
			'Apply Text to Packing List,1,2632,"""Y"" to apply, ""N"" for do not apply
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2632,V.Local.sTemp)
			'Apply Text to Invoice,1,2633,"""Y"" to apply, ""N"" for do not apply
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2633,V.Local.sTemp)
			'Apply Text to Quote,1,2634,"""Y"" to apply, ""N"" for do not apply
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2634,V.Local.sTemp)
			'Apply Text to Router,1,2635,"""Y"" to apply, ""N"" for do not apply
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2636,V.Local.sTemp)
			'Apply Text to Work Order,1,2636,"""Y"" to apply, ""N"" for do not apply
			V.Local.sRet.Set("")

			F.Intrinsic.String.Build("{0}{1}",V.Local.sTemp,V.Local.sRet,V.Local.sTemp)
			F.Intrinsic.String.RPad(V.Local.sTemp," ",2637,V.Local.sTemp)
			'Filler,1000,2637,Not in Use - Leave Blank

			'Filler,1000,3637,Not in Use - Leave Blank

			'***Total Record length of,4565 if all used

			'Build File Contents in Separate Temp Var
			F.Intrinsic.String.Build("{0}{1}{2}",V.Local.sFileContents,V.Local.sTemp,V.Ambient.NewLine,V.Local.sFileContents)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)

	F.Intrinsic.String.Build("{0}\WEB_ORDERS\{1}.txt",V.Caller.FilesDir,V.Local.sOrders(v.Local.iOrder).Trim,V.Local.sFile)

	'String to File containing sFileContents to v.Args.File Passed from other Prgrm
	F.Intrinsic.File.String2File(V.Local.sFile,V.Local.sFileContents)
	V.Local.sFileContents.Set("")

F.Intrinsic.Control.Next(V.Local.iOrder)

F.Intrinsic.String.Format(V.Ambient.Time,"HHMMSS",V.Local.sTime)
F.Intrinsic.String.Format(V.Ambient.Date,"MMDDYYYY",V.Local.sDate)



'Call Upload Web Importer ORDUPL
f.Global.General.overridecompany(v.global.utargetcompcode)
F.Global.General.CallWrapperSync(50,"ORDUPL")
'F.Global.General.CallWrappersync(51,V.global.utargetcompcode,"ORDUPL")
f.Global.General.overridecompany(v.global.ucurrentcompanycode)

'F.Intrinsic.Debug.InvokeDebugger
'F.Intrinsic.Debug.Stop

F.Intrinsic.String.Build("delete from GLOBAL{0}.order_header where order_no + ltrim(record_no) in {1} ",V.global.utargetcompcode,V.global.sOrderLnList,V.Local.sSql)

F.ODBC.Connection!con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("insert  into GLOBAL{0}.order_header select * from GLOBAL{1}.order_header where order_no + ltrim(record_no)  in {2} ",V.global.utargetcompcode,V.global.uCurrentCompanyCode,V.global.sOrderLnList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("update GLOBAL{0}.order_header set Customer = '{1}' where order_no + ltrim(record_no) in {2} ",V.global.utargetcompcode,V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sOrderLnList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("delete from GLOBAL{0}.order_lines where order_no +  record_no in {1} ",V.global.utargetcompcode,V.global.sOrderLnList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("insert  into GLOBAL{0}.order_lines select * from GLOBAL{1}.order_lines where order_no + record_no  in {2} ",V.global.utargetcompcode,V.global.uCurrentCompanyCode,V.global.sOrderLnList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("update GLOBAL{0}.order_lines set Customer = '{1}' where order_no +  record_no in {2} ",V.global.utargetcompcode,V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sOrderLnList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("delete from GLOBAL{0}.Cost_goods_sold where order_no +  Order_Line in {1}  ",V.global.utargetcompcode,V.global.sOrderLnList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)

F.Intrinsic.String.Build("insert  into GLOBAL{0}.Cost_goods_sold select * from GLOBAL{1}.Cost_goods_sold where order_no + Order_Line  in {2} ",V.global.utargetcompcode,V.global.uCurrentCompanyCode,V.global.sOrderLnList,V.Local.sSql)
F.ODBC.Connection!con.Execute(V.Local.sSql)



'F.Intrinsic.Debug.InvokeDebugger
'F.Intrinsic.Debug.Stop

'f.Global.General.overridecompany(v.global.utargetcompcode)
'F.Intrinsic.String.Build("update order_bill_to set Customer = '{0}' ,name_customer= vbill.name_customer,address_1=address1,address_2=address2,City= vbill.city,State=vbill.state,zip_code=zip,attention =  vbill.attention from v_customer_master as vbill where vbill.customer = '{0}'  and order_no + ltrim(record_no) in {1} ",V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sOrderaddList,V.Local.sSql)
'F.ODBC.Connection!con.Execute(V.Local.sSql)
'
'F.Intrinsic.String.Build("update order_ship_to set Customer = '{0}' ,name_customer_ship=vship.name_customer_ship,address_1_Ship=address1_ship,address_2_Ship=address2_ship,City_ship=city_ship,State_ship=state_ship,Code_zip_ship=code_zip_ship,attention_ship = attention_ship from v_customer_shipto as vship where vship.customer = '{0}'  and order_no + ltrim(record_no) in {1} ",V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sOrderaddList,V.Local.sSql)
'F.ODBC.Connection!con.Execute(V.Local.sSql)
'
'f.Global.General.overridecompany(v.global.ucurrentcompanycode)

V.Local.sCon.Declare(String)


F.Intrinsic.String.Build("GLOBAL_{0}",V.global.utargetcompcode,V.Local.sCon)

F.ODBC.Connection!conx.OpenConnection(V.Local.sCon,V.Ambient.PUser,V.Ambient.PPass,10000)

F.Intrinsic.String.Build("update order_bill_to set Customer = '{0}' ,name_customer= vbill.name_customer,address_1=address1,address_2=address2,City= vbill.city,State=vbill.state,zip_code=zip,attention =  vbill.attention from v_customer_master as vbill where vbill.customer = '{0}'  and order_no + ltrim(record_no) in {1} ",V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sOrderaddList,V.Local.sSql)
F.ODBC.Connection!conx.Execute(V.Local.sSql)

F.Intrinsic.String.Build("update order_ship_to set Customer = '{0}' ,name_customer_ship=vship.name_customer_ship,address_1_Ship=address1_ship,address_2_Ship=address2_ship,City_ship=city_ship,State_ship=state_ship,Code_zip_ship=code_zip_ship,attention_ship = attention_ship from v_customer_shipto as vship where vship.customer = '{0}'  and order_no + ltrim(record_no) in {1} ",V.Screen.frmcrosscopy!txtTcmpy.MetaData0,V.global.sOrderaddList,V.Local.sSql)
F.ODBC.Connection!conx.Execute(V.Local.sSql)

F.ODBC.Connection!conx.Close

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("Upload_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: ORDUPL_UPLOAD.lib",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
	F.Intrinsic.Control.End

Function.Intrinsic.Control.EndIf

Program.Sub.OrdLIb.End

Program.Sub.RouterUpload.Start
	Function.Intrinsic.UI.InvokeWaitDialog("Copying Router .......... Please wait")
		'create the router and line uploads
		F.Intrinsic.Control.CallSub(Routerheader2)

		V.uGlobal.uRtr.Redim(-1,-1)


		F.Intrinsic.Control.CallSub(Routerline2)
		Function.Intrinsic.UI.CloseWaitDialog



Program.Sub.RouterUpload.End

Program.Sub.WOupload.Start



Function.Intrinsic.UI.InvokeWaitDialog("Copying Job Header.......... Please wait")
F.Intrinsic.Control.CallSub(Jobcostheader)

Function.Intrinsic.UI.InvokeWaitDialog("Copying Job Operation .......... Please wait")
F.Intrinsic.Control.CallSub(Jobcostoperation)
Function.Intrinsic.UI.CloseWaitDialog

Program.Sub.WOupload.End

Program.Sub.OrderUpload.Start

F.Intrinsic.Control.SetErrorHandler("OrderUpload_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)

V.Local.sSql.Declare(String)


Function.Intrinsic.UI.InvokeWaitDialog("Copying SalesOrder .......... Please wait")
F.Intrinsic.Control.CallSub(Loaduorders)
F.Intrinsic.Control.CallSub(Ordlib,"sOrders",V.Global.sOrders)
Function.Intrinsic.UI.CloseWaitDialog


F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("OrderUpload_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf




Program.Sub.OrderUpload.End

Program.Sub.ParamFile.Start
F.Intrinsic.Control.SetErrorHandler("ParamFile_Err")
F.Intrinsic.Control.ClearErrors

V.Local.sError.Declare(String)


V.Local.sfilevalue.Declare(String)
V.Local.sfilepath.Declare(String)
V.Local.sdir.Declare(String)
V.Local.sNline.Declare(String)

V.Local.sNline.set(V.Ambient.NewLine)


F.Intrinsic.String.Build("{0}\WEB_ORDERS",Variable.Caller.FilesDir,V.Local.sdir)
Function.Intrinsic.File.CreateDir(V.Local.sdir)
F.Intrinsic.String.Build("{0}\WEB_ERRORS",V.Local.sdir,V.Local.sfilepath)
Function.Intrinsic.File.CreateDir(V.Local.sfilepath)
F.Intrinsic.String.Build("{0}\CONVERTED",V.Local.sdir,V.Local.sfilepath)
Function.Intrinsic.File.CreateDir(V.Local.sfilepath)
F.Intrinsic.String.Build("{0}\UPLOADED",V.Local.sdir,V.Local.sfilepath)
Function.Intrinsic.File.CreateDir(V.Local.sfilepath)

F.Intrinsic.String.Build("WEB ORDER DIRECTORY   = {0}{1}",V.Local.sdir,V.Local.sNline,V.Local.sfilevalue)
F.Intrinsic.String.Build("{0}WEB ERROR DIRECTORY   = {1}\WEB_ERRORS {2}",V.Local.sfilevalue,V.Local.sdir,V.Local.sNline,V.Local.sfilevalue)
F.Intrinsic.String.Build("{0}WEB CONVERTED DIR     = {1}\CONVERTED {2}",V.Local.sfilevalue,V.Local.sdir,V.Local.sNline,V.Local.sfilevalue)
F.Intrinsic.String.Build("{0}WEB UPLOADED DIRECTORY= {1}\UPLOADED {2}",V.Local.sfilevalue,V.Local.sdir,V.Local.sNline,V.Local.sfilevalue)

F.Intrinsic.String.Build("{0}EMAIL FROM ADDRESS    = name@company.com {1}",V.Local.sfilevalue,V.Local.sNline,V.Local.sfilevalue)
F.Intrinsic.String.Build("{0}EMAIL TO ADDRESS      = name@company.com",V.Local.sfilevalue,V.Local.sfilevalue)
'
F.Intrinsic.String.Build("{0}\GSSPARAM.txt",V.Caller.FilesDir,V.Local.sfilepath)
F.Intrinsic.File.String2File(V.Local.sfilepath,V.Local.sfilevalue)

F.Intrinsic.Control.ExitSub

F.Intrinsic.Control.Label("ParamFile_Err")
F.Intrinsic.Control.If(V.Ambient.ErrorNumber,<>,0)
	Function.Intrinsic.String.Concat("Project: GCG_3026_CrossCmpyProcess.gas",V.Ambient.Newline,V.Ambient.Newline,"Subroutine: ",V.Ambient.CurrentSubroutine,V.Ambient.NewLine,"Error Occurred ",V.Ambient.ErrorNumber," with description ",V.Ambient.ErrorDescription,V.Local.sError)
	F.Intrinsic.UI.Msgbox(V.Local.sError)
Function.Intrinsic.Control.EndIf


Program.Sub.ParamFile.End

Program.Sub.Comments.Start
${$0$}$GCG_CrossCmpyProcess$}$RAN$}$10/13/2015$}$False
Program.Sub.Comments.End

